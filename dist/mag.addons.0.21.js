/*
Mag.JS AddOns v0.21
(c) Michael Glazer
https://github.com/magnumjs/mag.js
Requires: MagJS (core) Addons: Ajax (mag.request) , Router (mag.route)
*/
!function(e,t,n,r){e.noop=function(){},e.namespace=function(t,n){var r=t.split("."),i=r.shift();return n=n||this,n[i]=n[i]||{},r.length?e.namespace(r.join("."),n[i]):n[i]},e.copy=e.utils.copy,e.merge=e.utils.merge,e.show=function(t,n){var r=typeof t;return"object"!==r?(r={_config:function(e){e.style.display=t?"block":"none"}},"object"==typeof n&&e.merge(n,r),r):void("object"==r?t.willload=function(e,t){t.style.display="block"}:t.willupdate=function(e,t,r){t.style.display=r[n]?"block":"none"})},e.deferred=function(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e},e.when=function(e,t){Promise.all(e).then(t)},e.request=function(t){var n=e.deferred(),r=new XMLHttpRequest,i=(t.method||"GET").toUpperCase();return r.open(i,t.url),r.send("GET"!==i&&t.data?t.data:""),r.onload=function(e){n.resolve(e.target.responseText)},r.onerror=function(e){n.reject(e)},n.promise},e.requestWithFeedback=function(t){var r=JSON.stringify(t);if(!e.requestWithFeedback.cache[r]){for(var i,o=n.querySelectorAll(".loader"),a=0;i=o[a];a++)i.style.display="block";var s=function(t){if(delete e.requestWithFeedback.cache[r],0==Object.keys(e.requestWithFeedback.cache).length)for(var n,i=0;n=o[i];i++)n.style.display="none";return t};e.requestWithFeedback.cache[r]=e.request(t).then(s,function(e){throw s(e),e})}return e.requestWithFeedback.cache[r]},e.requestWithFeedback.cache={},e.disable=function(e,t){"object"!=typeof this[e]&&(this[e]={_value:this[e]});var n=this[e]._config?this[e]._config:function(){};this[e]._config=function(e){n.call(this,arguments),t()?e.setAttribute("disabled","disabled"):e.removeAttribute("disabled")}},e.find=function(t,r){var i=n.getElementById(t);return e.fill.find(i,r)},e.toMenu=function(e,t){return e.map(function(e,n){return{_text:e,_value:n,_selected:t===n||t===e?!0:null}})},e.route=function(e){function t(){for(var t=e.location.hash.substr(1).split("/"),i=t.length,o=0;o<n.length;o++){var a=n[o];if(a.parts.length===i){for(var s=[],u=0;i>u;u++)if(":"===a.parts[u].substr(0,1))s.push(t[u]);else if(a.parts[u]!==t[u])break;if(u===i)return a.handler.apply(r,s),r}}}var n=[];return e.onhashchange=t,{addRoute:function(e,t){n.push({parts:e.split("/"),handler:t})},load:function(t){e.location.hash=t},start:t}}(t),e.hookin("attributes","key",function(){}),e.hookin("attributes","className",function(e){e.key="class";var t=e.value;if("string"==typeof e.value)t=e.value.split(" ");else if("object"==typeof e.value){for(var n in t)e.node.classList.toggle(n,t[n]);return e.value=e.node.classList+"",r}e.value=e.node.classList+"";for(n in t){var i=t[n];i.trim()&&0<e.node.classList.length&&!e.node.classList.contains(i.trim())?e.value=e.node.classList+" "+i:i.trim()&&0==e.node.classList.length&&(e.value+=i+" ")}e.value=e.value.trim()}),e.prop=function(e){var t=function(){return arguments.length&&(e=arguments[0]),e};return t.toJSON=function(){return e},t.type="fun",t},e.withProp=function(e,t){return function(n){n=n||event,n=n.currentTarget||this,t(e in n?n[e]:n.getAttribute(e))}}}(mag,window,document);
