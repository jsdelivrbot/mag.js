/*
Mag.JS v0.23.6
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
!function(e,t,n){function i(e,t){if(a[e]&&!t)return a[e];var n=mag.doc.getElementById(e);return n&&(a[e]=n),a[e]}e.mag=mag={},mag.doc=t;var r={values:[],attributes:[],elementMatcher:[]},a=[];mag.create=function(e,t,n){return function(i,r){return"string"!=typeof i&&(r=i,i=0),mag.module(i||e,t,mag.utils.merge(n||{},r||{}))}},mag.module=function(e,t,n){if(n=n||{},e instanceof HTMLElement&&(e.id||(e.id=performance.now()),a[e.id]=e,e=e.id),!mag.utils.items.isItem(e)||!I(mag.utils.items.getItem(e),i(e))){var r;r=n.key&&mag.utils.items.isItem(e+"."+n.key)?mag.utils.items.getItem(e+"."+n.key):mag.utils.getItemInstanceId(n.key?e+"."+n.key:e),n.retain||mag.mod.clear(r),mag.mod.submodule(e,r,t,n);var o=i(e);if(v(r,e),!mag.utils.callLCEvent("willload",mag.mod.getState(r),o,r,1))return mag.redraw(o,r,1),mag.utils.callLCEvent("didload",mag.mod.getState(r),o,r,1),m(r,o,t,mag.utils.copy(n))}};var o=function(e,t){return 0>t||t!=mag.utils.items.getItem(e)?e==mag.mod.getId(t)?!0:!1:!0},d=[];mag.begin=function(e){n===d[e]?d[e]=1:d[e]++},mag.end=function(e){if(d[e]>1)d[e]--;else{d[e]=0;var t=mag.utils.items.getItemVal(e);mag.redraw(i(t),e)}};var u=[];mag.redraw=function(e,t,i){if(!d[t]){if(!e||n===t)throw Error("Mag.JS - Id or node invalid: "+mag.utils.items.getItemVal(t));if(!o(e.id,t))return;i&&mag.fill.configs.splice(0,mag.fill.configs.length),i&&mag.mod.clear(t);var r=p(e,t,i);cancelAnimationFrame(u[t]),u[t]=requestAnimationFrame(r)}},mag.hookin=function(e,t,n){r[e].push({context:{},handler:n,key:t})},mag.hook=function(e,t,n){for(var i=0,a=r[e].length;a>i;i++)mag.utils.callHook(r,t,e,i,n)};var c={},l=[],f=function(e,t){mag.utils.onLCEvent("didupdate",e,function(n,r){var a=mag.utils.merge(mag.utils.copy(r),mag.utils.copy(n));JSON.stringify(a)!==JSON.stringify(l[e])&&(t(n,r,i(mag.mod.getId(e)),l[e]),l[e]=a)})},g=[],s=function(e,t,n,i,r){var a=mag.utils.items.getItem(t);mag.mod.submodule(e.id,a,i,n),mag.utils.callLCEvent("willgetprops",mag.mod.getState(a),e,a,0,n)||(v(a,e.id),mag.redraw(e,a,r))},m=function(e,t,n,i){g[e]=g[e]||[];var r=function(e,t,n,i,r){"object"==typeof r&&(i=mag.utils.merge(mag.utils.copy(i)||{},r),r=0);var a=t.id+(i.key?"."+i.key:"")+"."+(r||0),o=c[a]=c[a]||t.cloneNode(1);if(o.id=a,mag.utils.items.isItem(a))return s(o,a,i,n,1),o;var d=mag.utils.getItemInstanceId(o.id);return g[e].push({instanceId:d,subscribe:f.bind({},d)}),s(o,a,i,n,1),o}.bind({},e,t,n,i);return r.clones=function(e){return g[e]}.bind({},e),r.destroy=function(e,t){var n=mag.getNode(mag.mod.getId(e));mag.utils.callLCEvent("onunload",mag.mod.getState(e),n,e)||(mag.clear(e),b(e,n),r.clones(e).length=0,t&&mag.fill.removeNode(n))}.bind({},e),r.getId=function(e){return e}.bind({},e),r.draw=function(e,t,n){mag.redraw(e,t,n)}.bind({},t,e),r.getState=function(e,t){return mag.mod.getState(t||e)}.bind({},e),r.getProps=function(e,t){return mag.mod.getProps(t||e)}.bind({},e),r.subscribe=f.bind({},e),r},v=function(e,t){var n=function(e,t){i(t)?mag.redraw(i(t),e):mag.utils.items.isItem(t)&&mag.clear(e)}.bind({},e,t);mag.mod.setFrameId(e,n)};mag.clear=function(e){cancelAnimationFrame(u[e]),mag.utils.items.removeItem(e),mag.mod.clear(e),mag.fill.clearCache(mag.mod.getId(e))};var p=function(e,t,r){return function(e,t,r){if(i(e.id,1),o(e.id,t)&&e){var a=mag.mod.getState(t);if(!mag.utils.callLCEvent("isupdate",a,e,t))return mag.mod.iscached(t)&&!r?0:(mag.utils.callLCEvent("willupdate",a,e,t)||(mag.mod.callView(e,t),mag.fill.setId(e.id),mag.fill.run(e,a),h(e.id,mag.fill.configs),mag.utils.callLCEvent("didupdate",a,e,t),mag.mod.iscached(t)),n)}}.bind({},e,t,r)},h=function(e,t){for(var n in t)n.indexOf('id("'+e+'")/')>-1&&t[n]()},y=function(e){var t=[];for(var n in mag.fill.cached)n.indexOf('id("'+e+'")/')>-1&&n.indexOf("-config")>-1&&mag.fill.cached[n].configContext&&t.push({path:n.split("-config")[0],controller:mag.fill.cached[n].configContext,handler:mag.fill.cached[n].configContext.onunload});return t},b=function(e,t){for(var n,i=y(t.id,e),r=0,a=i;n=a&&a[r];r++)n.controller.onunload&&(n.handler.call(n.controller,t,n.path),n.controller.onunload=0)},I=function(e,t){return mag.utils.callLCEvent("onreload",mag.mod.getState(e),t,e)};mag.getNode=i}(window,document),function(e){"use strict";function t(t,n){var i=t.name;if(void 0===t.object[t.name]){var r,a=e.fill.find(n,i),o="$"===i[0],d=[];return a.reverse().forEach(function(e){e&&(e.value&&e.value.length>0?(r=e.value,!e.type||"checkbox"!=e.type&&"radio"!=e.type||(r={_value:r},e.checked&&(r._checked=!0),d.push(r))):e.innerText&&e.innerText.length>0?r=e.innerText:e.innerHTML&&e.innerHTML.length>0?r=e.innerHTML:e.value||"INPUT"!=e.tagName||(r=""))}),d.length>0&&o?d:r}}function n(n,i){var u;if("undefined"!=typeof Proxy){var c=function(n,i){var u=JSON.stringify(i.object),c=String(i.name);if(u!==o[n+c]){if(o[n+c]=u,"get"!=i.type||~e.fill.ignorekeys.indexOf(String(i.name))||void 0!==i.oldValue||0!==Object.keys(i.object).length)"set"==i.type&&i.object[i.name]&&i.object[i.name].draw&&"function"==typeof i.object[i.name].draw&&(r.innerMods[r.getId(n)]=[i.name,i.object[i.name]]);else{var l=t(i,e.doc.getElementById(r.getId(n)));if(void 0!==l)return d[n]=0,l}var f=r.getFrameId(n);"function"==typeof f&&"set"==i.type&&(cancelAnimationFrame(a[n]),a[n]=requestAnimationFrame(f))}};u=new n(e.proxy({},c.bind({},i)))}else u=new n({});return u}var i=[],r={innerMods:[],cache:[]};r.getState=function(e){return i[e][1]},r.setState=function(e,t){i[e][1]=t},r.getView=function(e){return i[e][0]},r.getProps=function(e){return i[e][2]},r.setProps=function(e,t){return i[e][2]=t},r.remove=function(e){i.splice(e,1)},r.getId=function(e){return i[e]&&i[e][3]},r.exists=function(e){return void 0!==i[e]?!0:!1},r.setFrameId=function(e,t){i[e][4]=t},r.getFrameId=function(e){return i[e][4]},r.submodule=function(t,a,o,d){if(i[a])return d.key&&d.key===r.getProps(a).key?r.setProps(a,e.utils.copy(e.utils.merge(r.getProps(a),d))):r.setProps(a,d),i[a];i[a]=[0,0,0,0,0],r.setProps(a,d);var u=function(e){return(o.controller||function(){}).call(e,r.getProps(a))||e},c=function(e,t,n){o.view.call(o,t,r.getProps(e),n)}.bind({},a),l={controller:u,view:c};return i[a][0]=l.view,i[a][3]=t,i[a][1]=n(l.controller,a,t),i[a]};var a=[],o=[];r.iscached=function(t){var n=e.utils.merge(e.utils.copy(r.getProps(t)),r.getState(t));return r.cache[t]&&r.cache[t]===JSON.stringify(n)?!0:void(r.cache[t]=JSON.stringify(n))},r.clear=function(e){e>-1&&r.cache[e]&&r.cache.splice(e,1)};var d=[];r.callView=function(t,n){var i=r.getView(n);d[n]||(e.props.attachToArgs(n,r.getState(n),t),d[n]=1),i(r.getState(n),t)},e.mod=r}(window.mag||{}),function(e){"use strict";function t(e){for(var t in e)if(e[t]&&-1!==["INPUT","SELECT","TEXTAREA"].indexOf(e[t].tagName))return e[t];return!1}var n={},i="__magnum__",r=function(t,n){for(var i=1;i<t.length;i+=2){var r=t[i],a=t[i+1];n=e.fill.find(n,r),n=n[a]}return n},a=function(n,a,o,d){var u,c=(""+o).split(".");if(c.length<3){var l=parseInt(c.pop()),f=isNaN(l)?0:l;u=e.fill.find(d[f]?d[f]:d,a)}else d=r(c,d),u=e.fill.find(d,a);var g=t(u);if(g&&!g.eventOnFocus){var s=["radio","checkbox"].indexOf(g.type)>-1,m=function(t,r){this[i]=this[i]||{},this[i].dirty||(this[i].dirty=1),r&&(n._checked=this.checked,e.redraw(t,e.utils.items.getItem(t.id),1))}.bind(g,d,s);s?g.addEventListener("click",m,!1):g.addEventListener("focus",m,!1),g.eventOnFocus=1}return g},o=function(n,r,o,d){var u=o[r];"_value"===r&&(r=n.split(".").pop());var c=e.fill.find(d,r),l=t(c);if("function"!=typeof u&&l){var f=a.bind({},o,r,n,d);f(),Object.defineProperty(o,r,{configurable:!0,get:function(){var t=f();return t&&"undefined"!==t.value&&t[i]&&t[i].dirty&&t.value!==u?(u=t.value,e.redraw(d,n,1),t.value):u},set:function(e){var t=f();t&&"undefined"!==t.value&&t.value!==e&&e!==u&&(t.value=e,u=e)}})}},d=function(e,t,n){for(var i in t){var r=t[i];"object"==typeof r?d(e+"."+i,r,n):o.bind({},e,i,t,n)()}};n.attachToArgs=d,e.props=n}(window.mag||{},window),function(e){"use strict";var t={};t.callHook=function(e,t,n,i,r,a){r.change=!1,e[n][i].key==t&&(a=JSON.stringify({v:r.value,k:r.key}),e[n][i].handler.call(e[n][i].context,r),a!==JSON.stringify({v:r.value,k:r.key})&&(r.change=!0))};var n=[];t.onLCEvent=function(e,t,i){n[e+"-"+t]=i},t.callLCEvent=function(t,i,r,a,o,d){var u=!1,c={preventDefault:function(){u=!0}};return i&&i[t]&&(i[t].call(i,c,r,e.mod.getProps(a),a,d),o&&(i[t]=0)),n[t+"-"+a]&&n[t+"-"+a](e.mod.getState(a),e.mod.getProps(a)),u},t.copy=function(e){return Object.assign({},e)},t.merge=function(){return Object.assign.apply({},arguments)};var i={i:[],isItem:function(e){return i.i.indexOf(e)>-1},setItem:function(e){i.i[i.i.length]=e},getItem:function(e){return i.i.indexOf(e)},getItemVal:function(e){return i.i[e]},removeItem:function(e){i.i.splice(i.i.indexOf(e),1)}};t.items=i,t.getItemInstanceIdAll=function(){return i.i},t.getItemInstanceId=function(e){return i.isItem(e)?i.getItem(e):(i.setItem(e),i.getItem(e))},e.utils=t}(window.mag||{}),function(e,t,n){"use strict";function i(e){return Array.isArray&&Array.isArray(e)||"[object Array]"==={}.toString.call(e)}function r(e,t){return e[T]=e[T]||{},(!e[T].uid||t)&&(e[T].uid=performance.now()),e[T].uid}function a(e,t){var n=r(e,t);return A[n]?A[n]:A[n]=u(e)}function o(e,t,i){var a=r(e,i);return P[O.id]=P[O.id]||[],P[O.id][a]&&P[O.id][a]==t?1:(P[O.id][a]=t,n)}function d(e){return e.id?e:e.parentNode?d(e.parentNode):n}function u(e){var t="",n=d(e),i=e.parentNode&&[].indexOf.call(e.parentNode.children,e);return n&&(t+='id("'+n.id+'")'),t+="/"+e.tagName+"["+(i+1)+"]"}function c(t){if(t.id)return'id("'+t.id+'")';if(t===e.doc.body)return t.tagName;var n=0;if(t.parentNode)for(var i=t.parentNode.childNodes,r=0;r<i.length;r++){var a=i[r];if(a===t)return c(t.parentNode)+(t.tagName?"/"+t.tagName+"["+(n+1)+"]":"");1===a.nodeType&&a.tagName===t.tagName&&n++}}function l(t){var n=c(t);t.parentNode.removeChild(t),t&&S[n+"-config"]&&S[n+"-config"].configContext&&typeof S[n+"-config"].configContext.onunload===j&&(S[n+"-config"].configContext.onunload(S[n+"-config"].configContext,t,n),delete S[n+"-config"],delete e.fill.configs[n])}function f(e){var t=e&&parseInt(e.split("[").pop().slice(0,-1));return t?parseInt(t)-1:0}function g(e){return e&&e.indexOf("id(")>-1&&e.split('id("')[1].split('")')[0]}function s(e){return e&&e[T]&&e[T].isChildOfArray?e:e.parentNode?s(e.parentNode):n}function m(t,n,i){if(!o(t,n.outerHTML,i)&&!e.doc.getElementById(n.id)){for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(n)}}function v(t,r,a){var d,u,c=f(a);if(r&&r.nodeType==_)return m(t,r),n;if("function"==typeof r){var l=s(t.parentNode),g=l&&l.getAttribute("key");l&&g&&(c=+g.split(T)[1]);var y=r(c);if(y&&y.nodeType&&y.nodeType==_)return m(t,y),t[T]=t[T]||{},t[T].isChildOfArray=!0,t[T].dataPass={index:c},r.draw(),n;var b=/<[a-z][\s\S]*>/i.test(y)?"_html":"_text",w={};return w[b]=y,v(t,w,a)}if("object"!=typeof r)return v(t,{_text:r},a);e.mod.innerMods[O.id]&&r[e.mod.innerMods[O.id][0]]&&!r[e.mod.innerMods[O.id][0]].draw&&e.mod.innerMods[O.id][1].destroy();for(var g in r){var N=r[g];N===n?N="":null===N&&-1===["onunload"].indexOf(g)?(t[T].detached=t[T].detached||[],t[T].detached[g]=1,h(t,g)):t[T].detached&&t[T].detached[g]&&(p(t,g),t[T].detached[g]=0),"_"===g[0]&&(d=d||{},d[g.substr(1)]=N)}!o(t,JSON.stringify(r))&&d&&I(t,d,a);for(var g in r){var N=r[g];if(!~O.ignorekeys.indexOf(g)&&"_"!==g[0]){u=k(t,g);var x={key:g,value:N,node:t};e.hook("values","*",x),x.change&&(N=x.value),i(N)&&(u=k(t,"$"+g)),O.run(u,N,a+"/"+g)}}}function p(e,t){var n=k(e,t);n.forEach(function(e){var t=r(e);if(J[t]){for(var n in J[t])e.appendChild(J[t][n]);delete J[t]}})}function h(e,t){var n=k(e,t);n.forEach(function(e){var t=r(e);for(e.children.length&&(J[t]=y(e.children));e.lastChild;)l(e.lastChild)})}function y(e){var t;if(null==e.length&&(e=[e]),!i(e)){t=[];for(var n=0;n<e.length;n+=1)e[n]&&t.push(e[n]);e=t}return e}function b(t,n,i){var r=function(t,n,i){var r=s(n),o=r&&c(r),d=f(o),u=a(n),l=f(u),m={path:o,data:((r||{})[T]||[]).dataPass,node:r,index:d},v=g(u),p=e.doc.getElementById(v),h=t.call(n,i,l,n,m);return e.redraw(p,e.utils.items.getItem(v)),h}.bind({},n[i],t);return r}function I(n,i,r){var a=f(r);for(var o in i)if("text"!==o&&"html"!==o)if(0==o.indexOf("on"))n[o.toLowerCase()]=b(n,i,o);else{if("config"==o){var r=c(n),a=f(r),d=!0;S[r+"-config"]?d=!1:S[r+"-config"]={};var u=S[r+"-config"].configContext=S[r+"-config"].configContext||{},l=function(e,t){return function(){return e.apply(e,t)}};t[r]=l(i[o],[n,d,u,a]);continue}var g={key:o,value:i[o],node:n};e.hook("attributes",o,g),g.change&&(o=g.key,i[o]=g.value),null===i[o]?n.removeAttribute(o):(o in n&&(n[o]=i[o]),n.setAttribute(o,""+i[o]))}w(n,i.text),N(n,i.html)}function w(e,t){var n,i;if(e&&null!=t){if(!i){i=[];for(var r=0;r<e.childNodes.length;r+=1)n=e.childNodes[r],n.nodeType===_&&i.push(n)}for(;e.lastChild;)e.removeChild(e.lastChild);"INPUT"===e.nodeName?e.value=""+t:e.appendChild(e.ownerDocument.createTextNode(""+t));for(var r=0;r<i.length;r+=1)e.appendChild(i[r]);"SELECT"===e.nodeName&&(e.value=""+t)}}function N(e,t){e&&null!=t&&(e.innerHTML=t)}function k(t,n,i){var r=x(t),a=[],o=n,d="$"===n[0];"$"===o[0]&&(o=o.substr(1));for(var u=0;u<r.length;u+=1)C(r[u],o)&&a.push(r[u]);if(!a.length||d)for(var u=0;u<r.length&&(a=a.concat(k(r[u],n,!0)),!a.length||d);u++);if(!i&&!a.length){var c={key:n,value:a,node:t};e.hook("elementMatcher",n,c),c.change&&(a=c.value)}return a}function x(e){var t=[];if(e){var n=e.childNodes;if(n)for(var i=0;i<n.length;i+=1)n[i].nodeType===_&&t.push(n[i])}return t}function C(e,t){var n=" "+e.className+" ";return e.id===t||n.indexOf(" "+t+" ")>-1||e.name===t||e.nodeName.toLowerCase()===t.toLowerCase()||e.getAttribute("data-bind")===t}var O={cached:[],ignorekeys:["willgetprops","Symbol(Symbol.toStringTag)","nodeType","toJSON","onunload","onreload","willupdate","didupdate","didload","willload","isupdate"]},_=1,S=O.cached,T="__magnum__",j="function",E="undefined",L="_key",A=[],P=[],M={};O.run=function(e,t,r){var o,d,u;if(e){null==t&&(t={_text:""});var c=y(e);if(u=i(t)){if(M[r]&&0===c.length&&(M[r].parent.insertAdjacentHTML("beforeend",M[r].node),c=y(M[r].parent.children)),0===c.length)return;for(d=c[0].parentNode,M[r]||(M[r]={node:c[0].cloneNode(1).outerHTML,parent:d});c.length<t.length;)M[r]?(d.insertAdjacentHTML("beforeend",M[r].node),o=d.lastChild):o=c[0].cloneNode(1),c.push(o),d&&d.appendChild(o);var f=(c.map(function(e){return e.__key}),t.map(function(e){return e&&e[L]}));if(c.length==t.length||-1!==f.indexOf(n))var t=t.map(function(e,t){if("object"==typeof e){if(c[t].__key&&typeof e[L]===E)return e[L]=c[t].__key,e;typeof e[L]===E&&(e[L]=T+t),c[t].__key=e[L]}return e});if(c.length>t.length)if(0===t.length||"object"!=typeof t[0])for(;c.length>t.length;)o=c.pop(),d=o.parentNode,d&&l(o);else var g=[],s=t.map(function(e){return e[L]}),c=(c.map(function(e){return e.__key}),c.filter(function(e){return-1===s.indexOf(e.__key)||-1!==g.indexOf(e.__key)?(g.push(e.__key),l(e),!1):(g.push(e.__key),!0)}))}for(var m=0;m<c.length;m++)if(u)c[m]&&O.run(c[m],t[m]);else{t&&"object"==typeof t&&-1!==Object.keys(t).indexOf(L)&&(c[m][T]=c[m][T]||{},c[m][T].isChildOfArray=!0,c[m][T].dataPass=t);var p=a(c[m]);v(c[m],t,p)}return e}};var J=[];O.removeNode=l,O.configs=t,O.find=k,O.setId=function(e){O.id=e},O.clearCache=function(e){P[e]&&delete P[e]},e.fill=O}(window.mag||{},[]),function(e,t){function n(t,n){var i=[];return new Proxy(t,{get:function(t,r){var a=t[r],o=n({type:"get",object:e.utils.copy(t[r]),name:r,oldValue:i[r]});return void 0!==o&&(a=t[r]=o),a},deleteProperty:function(e,t){return n({type:"delete",name:t,object:e,oldValue:i[t]}),delete e[t]},set:function(t,r,a){return JSON.stringify(a)!==JSON.stringify(t[r])&&(i[r]=e.utils.copy(t[r])),n({type:"set",name:r,object:t,oldValue:i[r]}),t[r]=a,!0}})}function i(e,t){for(var i in e)Array.isArray(e[i])&&e[i].length<101&&(e[i]=n(e[i],t));return n(e,t)}e.proxy=function(n,r){if(n&&t.Proxy){var a=function(t){return"object"==typeof t.object[t.name]&&(t.object[t.name]=e.proxy(t.object[t.name],r)),r(t)};return i(n,a)}}}(window.mag||{},window);
