/*
Mag.JS v0.28.3
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
(function(b,c){'use strict';function g(Q,R){if(w[Q]&&!R)return w[Q];var S=mag.doc.getElementById(Q);return S&&(w[Q]=S),w[Q]}var h='KEY',j=0,l=['#'+h,'.'+h,h],n=function(Q,R){var S;for(var T in l){var U=l[T].replace(h,R);if(S=Q.querySelector(U),S)break}return S},q=function(Q){var R=mag.utils.items.getItemVal(Q),S=mag.getNode(R);return S},r=function(Q){if('string'==typeof Q){var R=q(~mag.mod.runningViewInstance||mag.utils.runningEventInstance),S=n(R||mag.doc,Q);if(S)return S}return Q},t=function(Q,R,S){var X,T=[],U=Q.cloneNode(1),W=[],Y=[],Z=function($){var _=Q;$=$||{};var aa;$.key&&(aa=$.key+'-'+Z.id);var ba=$.key?$.key+'-'+Z.id:Z.id;if(Y[ba]||(Y[ba]='object'==typeof S?mag.utils.copy(S):S),'object'==typeof $&&($=mag.utils.extend(Y[ba],$)),aa&&!T[aa]?_=T[aa]=U.cloneNode(1):aa&&T[aa]&&(_=T[aa]),X&&X==_[u].scid)throw Error('MagJS Error - recursive call:'+X);_[u]=_[u]||{},mag._cprops[ba]&&'object'==typeof $&&($.children=mag._cprops[ba]);var ca;return W[ba]!=mag.utils.toJsonString($)&&(ca=R($),X=_[u].scid=ba,W[ba]=mag.utils.toJsonString($),mag.fill.setId(_),mag.fill.run(_,ca),mag.fill.setId(0),X=0),_};return Z.id=++j,Z};b.mag=function(Q,R,S){if(Q=r(Q),R=r(R),S=S||{},mag.utils.isHTMLEle(R)&&mag.utils.isHTMLEle(Q))R[u]||mag.fill.run(R,Q);else{if('function'==typeof R&&mag.utils.isHTMLEle(Q)){try{t(Q.cloneNode(1),R,S)()}catch(T){}return t(Q,R,S)}return I(-1,g(mag._isNode(Q)),R,S)}};var u='__magnum__';mag.MAGNUM=u,mag.rafBounceIds=[],mag._cprops=[],mag.doc=c;var v={values:[],attributes:[],elementMatcher:[]},w=[],j=0;mag._isNode=function(Q){return mag.utils.isHTMLEle(Q)&&(!Q.id&&(Q.id=++j),w[Q.id]=Q,Q=Q.id),Q};var x=function(Q,R){var S,T=R?Q+'-'+R:Q;return S=mag.utils.items.isItem(T)?mag.utils.items.getItem(T):mag.utils.getItemInstanceId(T),S};mag.module=function(Q,R,S){S=S||{},Q=mag._isNode(Q);var T=x(Q,S.key),U=y(S,T,R,Q);return U?I(T,U,R,mag.utils.copy(S)):void 0};var y=function(Q,R,S,T){Q.retain||mag.mod.clear(R);var U=g(T);if(mag.mod.submodule(T,R,S,Q),J(R,T),!O(R,U))return mag.redraw(U,R,1).then(function(){P(R,U)}),U},z=function(Q,R){return 0>R||R!=mag.utils.items.getItem(Q)?Q==mag.mod.getId(R):!0},A=[];mag.begin=function(Q){'undefined'==typeof A[Q]?A[Q]=1:A[Q]++},mag.end=function(Q){if(1<A[Q])A[Q]--;else{A[Q]=0;var R=mag.utils.items.getItemVal(Q);mag.redraw(g(R),Q)}},mag.redraw=function(Q,R,S){if(!A[R]){if(!Q||'undefined'==typeof R)throw Error('Mag.JS - Id or node invalid: '+mag.utils.items.getItemVal(R));if(!z(Q.id,R))return{then:T=>T()};if(S&&mag.fill.configs.splice(0,mag.fill.configs.length),S&&mag.mod.clear(R),mag.mod.runningViewInstance==R)throw Error('Mag.JS - recursive call:'+R);return mag.utils.scheduleFlush(R,K(Q,R,S))}},mag.hookin=function(Q,R,S){v[Q].push({context:{},handler:S,key:R})},mag.hook=function(Q,R,S){for(var T=0,U=v[Q].length;T<U;T++)mag.utils.callHook(v,R,Q,T,S)};var B={},C=[],D=[],E=function(Q,R,S){var T=mag.getNode(mag.mod.getId(Q)),U=function(){mag.utils.callLCEvent('onunload',mag.mod.getState(Q),T,Q)||(mag.clear(Q),N(Q,T),R[Q]&&(R[Q].length=0),S&&(mag.fill.removeNode(T),mag.mod.remove(Q)))};mag.mod.getState(Q).onbeforeunload?mag.utils.callLCEvent('onbeforeunload',mag.mod.getState(Q),T,Q,0,function(){U()}):U()},F=function(Q,R){D[Q]=D[Q]||[];var S=D[Q].push(R);return mag.utils.onLCEvent('didupdate',Q,function(T,U){var V=mag.utils.merge(mag.utils.copy(U),mag.utils.copy(T));if(mag.utils.toJsonString(V)!=mag.utils.toJsonString(C[Q])){for(var W of D[Q])W(T,U,g(mag.mod.getId(Q)),C[Q]);C[Q]=V}}),function(){return D[Q].splice(S-1,1)}},G=[],H=function(Q,R,S,T,U){var V=mag.utils.items.getItem(R);(R=mag._isNode(Q),P(V,Q),!(mag.mod.exists(V)&&mag.utils.callLCEvent('willgetprops',mag.mod.getState(V),Q,V,0,S)))&&(mag.mod.submodule(Q.id,V,T,S),J(V,Q.id),O(V,Q)||mag.redraw(Q,V,U).then(function(){P(V,Q)}))},I=function(Q,R,S,T){G[Q]=G[Q]||[];var U=function(V,W,X,Y,Z){'object'==typeof Z&&(Y=mag.utils.merge(mag.utils.copy(Y),Z),Z=0);var $=W.id+(Y.key?'.'+Y.key+'.':'')+(Z||'');!B[$]||Y.key||~U._id||($+=++j);var _=B[$]=B[$]||W.cloneNode(1);if(_.id=$,mag.utils.items.isItem($))return H(_,$,Y,X,1),_;var aa=mag.utils.getItemInstanceId(_.id);return 0>V?V=U._id=aa:G[V].push({instanceId:aa,subscribe:F.bind({},aa)}),H(_,$,Y,X,1),_}.bind({},Q,R,S,T);return U._id=Q,U.clones=function(){return G[U._id]},U.destroy=function(V){E(U._id,U.clones,V)},U.getId=function(){return U._id},U.rafBounce=function(V){return V?mag.rafBounceIds[U._id]=1:!1===V&&(mag.rafBounceIds[U._id]=0),!!mag.rafBounceIds[U._id]},U.draw=function(V){return mag.redraw(R,U._id,V)},U.getState=function(){return mag.mod.getState(U._id)},U.getProps=function(){return mag.mod.getProps(U._id)},U.subscribe=function(V){return F(U._id,V)},U},J=function(Q,R){var S=function(T,U){g(U)?mag.redraw(g(U),T):mag.utils.items.isItem(U)&&mag.clear(T)}.bind({},Q,R);mag.mod.setFrameId(Q,S)};mag.clear=function(Q){mag.utils.items.removeItem(Q),mag.mod.clear(Q),mag.fill.clearCache(mag.mod.getId(Q))};var K=function(Q,R,S){return function(T,U,V){if(g(T.id,1),z(T.id,U)&&T){var W=mag.mod.getState(U);return mag.utils.callLCEvent('isupdate',W,T,U)?void 0:mag.mod.iscached(U)&&!V?0:void(mag.utils.callLCEvent('willupdate',W,T,U)||(mag.mod.callView(T,U),mag.fill.setId(T.id),mag.fill.run(T,W),mag.fill.setId(0),L(T.id,mag.fill.configs),mag.utils.callLCEvent('didupdate',W,T,U),!V&&mag.mod.iscached(U)))}}.bind({},Q,R,S)},L=function(Q,R){for(var S in R)S.startsWith('id("'+Q+'")/')&&R[S]()},M=function(Q){var S=[];for(var T in mag.fill.cached)-1<T.indexOf('id("'+Q+'")/')&&-1<T.indexOf('-config')&&mag.fill.cached[T].configContext&&S.push({path:T.split('-config')[0],controller:mag.fill.cached[T].configContext,handler:mag.fill.cached[T].configContext.onunload});return S},N=function(Q,R){for(var U,S=M(R.id,Q),T=0,V=S;U=V&&V[T];T++)U.controller.onunload&&(U.handler.call(U.controller,R,U.path),U.controller.onunload=0)},O=function(Q,R){return mag.utils.callLCEvent('willload',mag.mod.getState(Q),R,Q,1)},P=function(Q,R){var S=mag.utils.items.getItemVal(Q);if(g(S)&&mag.mod.exists(Q))return mag.utils.callLCEvent('didload',mag.mod.getState(Q),R,Q,1)};mag.getNode=g})(window||global||this,document),function(b){'use strict';function c(u,v){var w=u.name;if('undefined'==typeof u.object[u.name]&&'_'!=w[0]){var x=b.fill.find(v,w),y='$'===w[0],z=[];return x.length?(x.forEach(function(E){var F;if(!(E&&E.type&&!~['submit','button'].indexOf(E.type)))'undefined'==typeof u.oldValue&&'undefined'==typeof u.object[u.name]&&E&&!~['submit','button'].indexOf(E.type)&&1==E.childNodes.length&&E.childNodes[0].textContent.trim()&&(F={_text:E.childNodes[0].textContent.trim()});else if(E.value&&0<E.value.length)if('checkbox'!=E.type&&'radio'!=E.type)F={_value:E.value};else if(E.checked&&(F={},F._checked=!0),!y){var G=v.querySelectorAll('[name='+E.name+']');if(G.length)for(var H of G)H.checked&&(F?F._value=H.value:F={_value:H.value})}else F?F._value=E.value:F={_value:E.value};F?z.push(F):E&&!E.hasChildNodes()&&z.push(h)}),0===z.length?void 0:y?z:z[0]&&'undefined'!=typeof z[0]._value?z[0]._value:z[0]&&z[0]._text?z[0]._text:z[0]):h}if('_'==w[0]){var A=w.substr(1);if(v.length){var z=[];for(var B in v){var C=v[B],D=C[A];'undefined'==typeof D&&(D=C.getAttribute(A)),z.push(D)}return z}var D=v[A];return'undefined'==typeof D&&(D=v.getAttribute(A)),D}}function f(u,v){l.setProps(v,b.proxy(l.getProps(v),t.bind({},'props',v),'prop'));var x=new u(b.proxy({},t.bind({},'state',v)));return x}var g=[],h=b.MAGNUM,l={runningViewInstance:-1,innerMods:[],cache:[]};l.getState=function(u){return g[u][1]},l.setState=function(u,v){g[u][1]=v},l.getView=function(u){return g[u][0]},l.getProps=function(u){return g[u][2]},l.setProps=function(u,v){return g[u][2]=v},l.remove=function(u){g.splice(u,1)},l.getId=function(u){return g[u]&&g[u][3]},l.exists=function(u){return'undefined'!=typeof g[u]},l.setFrameId=function(u,v){g[u][4]=v},l.getFrameId=function(u){return g[u][4]},l.getMod=function(u){return g[u][5]};var n=(u,v)=>{for(var w in v=v||u,u){var x=u[w];'function'!=typeof x||~['controller','view'].indexOf(w)||(u[w]=x.bind(v))}return u};l.submodule=function(u,v,w,x){if(g[v])return x.key&&x.key==l.getProps(v).key?l.setProps(v,b.utils.copy(b.utils.merge(l.getProps(v),x))):l.setProps(v,x),g[v];w=b.utils.copy(w),n(w,w),g[v]=[0,0,0,0,0,0],l.setProps(v,x);var z=function(B,C,D){w.element=D,w.state=C,w.props=l.getProps(B),w.view&&w.view.call(w,C,w.props,D)}.bind({},v),A={controller:function(B){return w.props=l.getProps(v),w.state=B,w.element=b.getNode(u),(w.controller||function(){}).call(B,w.props)||B},view:z};return g[v][0]=A.view,g[v][3]=u,g[v][1]=f(A.controller,v,u),g[v][5]=w,g[v]};var q=[],r=function(u,v){var w=u,x=v.split('/');for(var y of x)if(y){var z=b.fill.find(w,y);z.length&&(w=z)}return w},t=function(u,v,w){if('get'==w.type&&'props'!=u&&!~b.fill.ignorekeys.indexOf(w.name.toString())&&'undefined'==typeof w.oldValue){var x=b.getNode(l.getId(v));if(w.path&&'/'==w.path[0])var y=r(x,w.path);y&&'$'!=w.path.split('/').pop()[0]&&(y=y[0]);var z=c(w,y?y:x);if(null!=z&&'undefined'!=typeof z&&'object'==typeof z&&w.object&&b.utils.merge(z,w.object[w.name]),'undefined'!=typeof z)return l.cached[v]=0,z}else'set'==w.type&&'props'!=u&&w.object[w.name]&&w.object[w.name].draw&&'function'==typeof w.object[w.name].draw&&(l.innerMods[l.getId(v)]=[w.name,w.object[w.name]]);var A=l.getFrameId(v);'function'==typeof A&&'set'==w.type&&(cancelAnimationFrame(q[v]),q[v]=requestAnimationFrame(A))};l.iscached=function(u){var v=b.utils.toJsonString(b.utils.merge(b.utils.copy(l.getProps(u)),l.getState(u)));return u in l.cache&&l.cache[u]==v||void(l.cache[u]=v)},l.remove=function(u){g[u]&&(g[u]=0)},l.clear=function(u){~u&&l.cache[u]&&l.cache.splice(u,1)},l.cached=[],l.callView=function(u,v){l.runningViewInstance=v,l.cached[v]||(b.props.attachToArgs(v,l.getState(v),u),l.cached[v]=1);try{l.getView(v)(l.getState(v),u)}finally{l.runningViewInstance=-1}},b.mod=l}(mag),function(b){'use strict';function f(v,w,x,y){var z=[];for(var A in v){var B=v[A];h(B)&&(z.push(B),g(B,w,x,y))}return!!z.length&&(1==z.length?z[0]:z)}function g(v,w,x,y){if(v[n]=v[n]||{},!v[n].eventOnFocus){var z=function(A,B,C){var E=~['radio','checkbox'].indexOf(v.type);this[n].dirty||(this[n].dirty=1),E?'_checked'in B||'_value'in B?B._checked=this.checked:this.checked&&(B[C]=this.value):void 0===B._value?void 0!==B._text&&(B._text=this.value):B._value=this.value,b.redraw(A,b.utils.items.getItem(A.id))}.bind(v,y,w,x);v.addEventListener('click',z,!1),v.addEventListener('input',z,!1),v.addEventListener('focus',z,!1),v[n].eventOnFocus=1}}function h(v){return v&&~['INPUT','SELECT','TEXTAREA'].indexOf(v.tagName)}function j(v){for(var w in v)if(h(v[w]))return v[w];return!1}var l={},n=b.MAGNUM,q=function(v,w){for(var x=1;x<v.length;x++){var y=v[x],z=v[x+1],A=b.fill.find(Array.isArray(w)?w[0]:w,y);if(z&&!isNaN(+z))w=A[z];else if(A&&A.length&&z&&x+2<v.length)w=b.fill.find(A[0],z);else if(A&&A.length&&(w=A,x+2==v.length))break}return Array.isArray(w)?w[0]:w},r=function(v,w,x,y){var A,z=x.toString().split('.');if(3<=z.length)y=q(z,y),A=b.fill.find(y,w);else{var B=parseInt(z.pop()),C=isNaN(B)?0:B;A=b.fill.find(y[C]?y[C]:y,w)}return f(A,v,w,y)},t=function(v,w,x,y){var z=x[w];~['_value','_checked','_text'].indexOf(w)&&'string'==typeof v&&(w=v.split('.').pop());var A=b.fill.find(y,w),B=j(A);if('function'!=typeof z&&B){var C=r.bind({},x,w,v,y);C(),Object.defineProperty(x,w,{configurable:!0,get:function(){var D=C();return D&&'undefined'!==D.value&&D[n]&&D[n].dirty&&D.value!==z?(z=D.value,b.redraw(y,v,1),D.value):z},set:function(D){var E=C();E&&'undefined'!==E.value&&E.value!==D&&D!==z&&(E.value=D,z=D)}})}},u=function(v,w,x){for(var y in w)if(w.hasOwnProperty(y)){var z=w[y];'object'!=typeof z||b.utils.isHTMLEle(z)?t.bind({},v,y,w,x)():(b.utils.isObject(z)&&b.utils.isEmpty(z)&&(z._value=''),u(v+'.'+y,z,x))}};l.attachToArgs=u,b.props=l}(mag),function(b){'use strict';function c(n,q){return'function'==typeof q?''+q:q}var f={isObject:n=>{return'Object]'==Object.prototype.toString.call(n).substr(-7)},toJsonString:n=>{return JSON.stringify(n,c)},isEmpty:n=>{for(var q in n)if(n.hasOwnProperty(q))return 0;return 1},isHTMLEle:n=>{return n&&1===n.nodeType},callHook:function(n,q,r,t,u,v){n[r][t].key==q&&(v={v:u.value,k:u.key},u.change=!1,n[r][t].handler.call(n[r][t].context,u),{v:u.value,k:u.key}!==v&&(u.change=!0))}},g=[],h=[];f.scheduleFlush=function(n,q){return new Promise(function(r){b.rafBounce||b.rafBounceIds[n]?(cancelAnimationFrame(h[n]),h[n]=requestAnimationFrame(function(){q(),r(),h[n]=0})):(g.push(q),h[n]?r():h[n]=requestAnimationFrame(function(){h[n]=0;for(var t;t=g.shift();)t();r()}))})};var j=[];f.onLCEvent=function(n,q,r){var t=n+'-'+q;j[t]=j[t]||[];var u=j[t].push(r);return function(){return j[t].splice(u-1,1)}},f.callLCEvent=function(n,q,r,t,u,v){var w;f.runningEventInstance=t;var x=b.mod.getProps(t),y=b.mod.getMod(t);y[n]?(w=y[n].call(y,r,x,t,v),u&&(y[n]=0)):q&&q[n]&&(w=q[n].call(y,r,x,t,v),u&&(q[n]=0));var z=n+'-'+t;if(j[z]){for(var A of j[z])A(q,x);u&&(j[z]=0)}return(f.runningEventInstance=-1,!1===w)||void 0},f.copy=function(n){return Object.assign({},n)},f.merge=function(){return Object.assign.apply({},arguments)},f.extend=function(n,q,r){for(var t in q)if(q[t]===void 0)delete q[t];else if(r&&f.isObject(q[t]))return f.extend(n[t],q[t]);return f.merge(n,q)};var l={i:[],isItem:function(n){return~l.i.indexOf(n)},setItem:function(n){l.i[l.i.length]=n},getItem:function(n){return l.i.indexOf(n)},getItemVal:function(n){return l.i[n]},removeItem:function(n){l.i.splice(l.i.indexOf(n),1)}};f.items=l,f.getItemInstanceIdAll=function(){return l.i},f.getItemInstanceId=function(n){return l.isItem(n)?l.getItem(n):(l.setItem(n),l.getItem(n))},b.utils=f}(mag),function(b,c,f){'use strict';function g(_){return Array.isArray(_)}function h(_,aa){return _[R]=_[R]||{},(!_[R].uid||aa)&&(_[R].uid=++Y),_[R].uid}function j(_,aa){var ba=h(_,aa);return V[ba]?V[ba]:V[ba]=q(_)}function l(_,aa,ba){var ca=h(_,ba);return W[P.id]=W[P.id]||[],W[P.id][ca]&&W[P.id][ca]==aa?1:void(W[P.id][ca]=aa)}function n(_){return _.id?_:_.parentNode?n(_.parentNode):void 0}function q(_){var aa='',ba=n(_),ca=_.parentNode&&[].indexOf.call(_.parentNode.children,_);return ba&&(aa+='id("'+ba.id+'")'),aa+='/'+_.tagName+'['+(ca+1)+']',aa}function r(_){if(_.id&&P.id===_.id)return'id("'+_.id+'")';if(_===b.doc.body)return _.tagName;var aa=0;if(_.parentNode)for(var da,ba=_.parentNode.childNodes,ca=0;ca<ba.length;ca++){if(da=ba[ca],da===_)return r(_.parentNode)+(_.tagName?'/'+_.tagName+'['+(aa+1)+']':'');1===da.nodeType&&da.tagName===_.tagName&&aa++}}function t(_){var aa=r(_);_&&Q[aa+'-config']&&Q[aa+'-config'].configContext&&typeof Q[aa+'-config'].configContext.onunload==='function'&&(Q[aa+'-config'].configContext.onunload(Q[aa+'-config'].configContext,_,aa),delete Q[aa+'-config'],delete P.configs[aa]),_.parentNode&&_.parentNode.removeChild(_),b.mod.cached[b.utils.items.getItem(P.id)]=0}function u(_){var aa=_&&parseInt(_.split('[').pop().slice(0,-1));return aa?parseInt(aa)-1:0}function v(_){return _&&~_.indexOf('id(')&&_.split('id("')[1].split('")')[0]}function w(_){if(_&&_[R]&&_[R].isChildOfArray)return _;return _.parentNode?w(_.parentNode):void 0}function x(_,aa,ba){if(!l(_,aa.outerHTML,ba)&&(!aa.id&&!_.childNodes[0]||aa.id&&!b.doc.getElementById(aa.id)||_.firstChild&&!_.firstChild.isEqualNode(aa))){var ca=b.utils.items.getItem(aa.id);if(~ca&&_.hasChildNodes()){var da=b.utils.items.getItem(P.id),ea=_.cloneNode(1);ea[R]={childof:da},b.mod.getProps(ca).children=ea}else aa[R]&&aa[R].scid&&(ea=_.cloneNode(1),ea[R]={childof:aa[R].scid},b._cprops[aa[R].scid]=ea);for(;_.lastChild;)_.removeChild(_.lastChild);if(aa[R]&&aa[R].childof!==f){_.innerHTML=aa.innerHTML;var fa=aa[R].childof;b._cprops[fa]||(y(_,fa),b.utils.onLCEvent('willupdate',fa,()=>{y(_,fa)}))}else _.appendChild(aa)}}function y(_,aa){var ba=P.id;P.setId(b.mod.getId(aa)),P.run(_,b.mod.getState(aa)),P.setId(ba)}function z(_,aa){var ba;for(var ca in aa){var da=aa[ca];da===f?da='':null===da&&-1===['onunload'].indexOf(ca)?(_[R].detached=_[R].detached||[],_[R].detached[ca]=1,D(_,ca)):_[R].detached&&_[R].detached[ca]&&(C(_,ca),_[R].detached[ca]=0),'_'===ca[0]&&'_'!==ca[1]&&(ba=ba||{},ba[ca.substr(1)]=da)}return ba}function A(_,aa,ba){var ca;for(var da in aa){var ea=aa[da];if(!~P.ignorekeys.indexOf(da)&&'_'!==da[0]){ca=L(_,da);var fa={key:da,value:ea,node:_};b.hook('values','*',fa),fa.change&&(ea=fa.value),P.run(ca,ea,ba+'/'+da)}}}function B(_,aa,ba,ca){var da,ha=u(ba);return aa&&b.utils.isHTMLEle(aa)?void x(_,aa):'function'==typeof aa?Z(aa,_,ha,ba):'object'==typeof aa?void(b.mod.innerMods[P.id]&&aa[b.mod.innerMods[P.id][0]]&&!aa[b.mod.innerMods[P.id][0]].draw&&b.mod.innerMods[P.id][1].destroy(),da=z(_,aa),da&&I(_,da,ba,ca),A(_,aa,ba)):B(_,{_text:aa},ba)}function C(_,aa){var ba=L(_,aa);ba.forEach(function(ca){var da=h(ca);if(da in $){for(var ea in $[da])ca.appendChild($[da][ea]);delete $[da]}})}function D(_,aa){var ba=0,ca=1,da=function(ga){if(++ba==ca)for(;ga.lastChild;)t(ga.lastChild)},ea=function(ga,ha){var ia;ga.id&&b.utils.items.isItem(ga.id)&&(ia=b.utils.items.getItem(ga.id)),ia&&b.mod.getState(ia).onbeforeunload?(ca++,b.utils.callLCEvent('onbeforeunload',b.mod.getState(ia),ga,ia,0,function(){ia&&b.utils.callLCEvent('onunload',b.mod.getState(ia),ga,ia),ha()})):(ia&&b.utils.callLCEvent('onunload',b.mod.getState(ia),ga,ia),ha())},fa=L(_,aa);fa.forEach(function(ga){var ha=h(ga);ga.children.length&&($[ha]=E(ga.children));for(var ja in $[ha]){var ka=$[ha][ja];ea(ka,function(){da(ga)})}da(ga)})}function E(_){var aa;if(null==_.length&&(_=[_]),!g(_)){aa=[];for(var ba=0;ba<_.length;ba+=1)_[ba]&&aa.push(_[ba]);_=aa}return _}function F(_,aa){var ba=function(ca,da,ea){var fa=w(da),ga=fa&&r(fa),ha=u(ga),ia=q(da),ja=u(ia),ka={path:ga,node:fa,data:((fa||{})[R]||[]).dataPass,index:ha},la=v(ia),ma=b.doc.getElementById(la),na=b.utils.items.getItem(la),oa=ca.call(~na?b.mod.getMod(na):ma,ea,ja,da,ka);if(la&&ma){var pa=function(){b.redraw(ma,na,1)};oa&&oa.then?oa.then(function(qa){return pa(),qa}):pa()}return oa}.bind({},aa,_);return ba}function G(_,aa){function ba(ca){var da=_[R].eventHandlers[aa];for(var ea in da){var fa=da[ea],ga=F(_,fa),ha=ga(ca);!1===ha&&ca.preventDefault()}}_.removeEventListener(aa,ba),_.addEventListener(aa,ba)}function H(_,aa,ba,ca){var da=aa.substr(2).toLowerCase(),ea=(ca?ca.split(')').pop():'')+'-'+ba[R].uid,fa=ba[R].events=ba[R].events||[],ga=ba[R].eventHandlers=ba[R].eventHandlers||[];ga[da]=ga[da]||[],ga[da][ea]=_,fa[da]||(fa[da]=1,G(ba,da))}function I(_,aa,ba,ca){var da=u(ba);for(var ea in Q[h(_)]=Q[h(_)]||[],aa)if('text'!==ea&&'html'!==ea)if(0==ea.indexOf('on'))H(aa[ea],ea,_,ca);else{if('config'==ea){var ba=r(_),da=u(ba),fa=!0;Q[ba+'-config']?fa=!1:Q[ba+'-config']={};var ga=Q[ba+'-config'].configContext=Q[ba+'-config'].configContext||{},ha=function(la,ma){return function(){return la.apply(la,ma)}};c[ba]=ha(aa[ea],[_,fa,ga,da]);continue}var ia={key:ea,value:aa[ea],node:_};if(b.hook('attributes',ea,ia),ia.change&&(ea=ia.key,aa[ea]=ia.value),Q[h(_)]&&Q[h(_)][ea]==aa[ea])continue;null===aa[ea]?_.removeAttribute(ea):ea in _?'style'==ea?_[ea].cssText=aa[ea]:_[ea]=aa[ea]:_.setAttribute(ea,aa[ea]+''),Q[h(_)][ea]=aa[ea]}J(_,aa.text),K(_,aa.html)}function J(_,aa){if(_&&null!=aa&&!l(_,aa)){var ba=aa+'';if('INPUT'!==_.nodeName)'SELECT'!==_.nodeName&&(_.firstChild?_.firstChild.textContent=ba:_.appendChild(_.ownerDocument.createTextNode(ba)));else if(!~['radio','checkbox'].indexOf(_.type))ba!=_.value&&(_.value=ba);else if(_.name){var ca=b.getNode(P.id).querySelectorAll('[name='+_.name+']');if(1<ca.length)for(var da of ca)if(da.value==ba){da.checked=!0;break}}'SELECT'===_.nodeName&&ba&&(_.value=ba)}}function K(_,aa){!_||null==aa||l(_,aa)||(_.innerHTML=b.utils.isHTMLEle(aa)?aa.innerHTML:aa)}function L(_,aa,ba){var ca=N(_),da=[],ea=aa,fa='$'===aa[0];'$'===ea[0]&&(ea=ea.substr(1));for(var ga=0;ga<ca.length;ga+=1)O(ca[ga],ea)&&da.push(ca[ga]);if(!da.length||fa)for(var ga=0;ga<ca.length&&(da=da.concat(L(ca[ga],aa,!0)),!da.length||fa);ga++);if(!ba&&!da.length){var ha={key:aa,value:da,node:_};b.hook('elementMatcher',aa,ha),ha.change&&(da=ha.value)}return da}function M(_){return P.id&&(b.utils.isHTMLEle(P.id)&&_[R]&&_[R].scid||_.id&&_.id!=P.id&&b.utils.items.isItem(_.id))?0:1}function N(_){var aa=[];if(_){var ba=_.childNodes;if(ba)for(var ca=0;ca<ba.length;ca+=1)1===ba[ca].nodeType&&M(ba[ca])&&aa.push(ba[ca])}return aa}function O(_,aa){var ba=' '+_.className+' ';return _.id===aa||~ba.indexOf(' '+aa+' ')||_.name===aa||_.nodeName.toLowerCase()===aa.toLowerCase()||_.getAttribute('data-bind')===aa}var P={cached:[],ignorekeys:['toString','draw','then','hasOwnProperty','willgetprops','onbeforeunload','Symbol(Symbol.toStringTag)','nodeType','toJSON','onunload','willupdate','didupdate','didload','willload','isupdate']},Q=P.cached,R=b.MAGNUM,T='undefined',U='_key',V=[],W=[],X={},Y=0;P.run=function(_,aa,ba){var ca,da;if(_){null==aa&&(aa={_text:''});var ea=E(_);if(da=g(aa),da){if(X[ba]&&0===ea.length&&(X[ba].parent.insertAdjacentHTML('beforeend',X[ba].node),ea=E(X[ba].parent.children)),!ea.length)return;var fa=ea[0].parentNode;for(X[ba]||(X[ba]={node:ea[0].cloneNode(1).outerHTML,parent:fa});ea.length<aa.length;)X[ba]?(fa.insertAdjacentHTML('beforeend',X[ba].node),ca=fa.lastChild):ca=ea[0].cloneNode(1),ea.push(ca),fa&&fa.appendChild(ca);var ga=aa.map(function(la){return la&&la[U]});if((ea.length==aa.length||-1!==ga.indexOf(f))&&(aa=aa.map(function(la,ma){if('object'==typeof la){if(ea[ma][R]=ea[ma][R]||{},ea[ma][R].__key&&typeof la[U]==T)return la[U]=ea[ma][R].__key,la;typeof la[U]==T&&(la[U]=R+ma),ea[ma][R].__key=la[U]}return la})),ea.length>aa.length)if(0===aa.length||'object'!=typeof aa[0])for(;ea.length>aa.length;)ca=ea.pop(),fa=ca.parentNode,fa&&t(ca);else{var ha=[],ia=aa.map(function(la){return la[U]});ea=ea.filter(function(la){var na;return(typeof la[R]==T?na=1:(!~ia.indexOf(la[R].__key)||~ha.indexOf(la[R].__key))&&(ha.push(la[R].__key),na=1),na)?(t(la),!1):(ha.push(la[R].__key),!0)})}}for(var ja=0;ja<ea.length;ja++)if(da)ea[ja]&&P.run(ea[ja],aa[ja]);else{var ka=j(ea[ja]);aa&&'object'==typeof aa&&aa.hasOwnProperty(U)&&(ea[ja][R].isChildOfArray=!0,!b.utils.isHTMLEle(aa)&&(ea[ja][R].dataPass=aa)),ea[ja][R].xpath=ka,B(ea[ja],aa,ka,ba)}}};var Z=function(_,aa,ba,ca){var da=w(aa.parentNode),ea=da&&da.getAttribute('key');da&&ea&&(ba=+ea.split(R)[1]);var fa=_(++ba,ca);if(fa&&b.utils.isHTMLEle(fa))x(aa,fa),aa[R]=aa[R]||{},aa[R].isChildOfArray=!0,aa[R].dataPass={index:ba},_.draw&&_.draw();else{var ga=/<[a-z][\s\S]*>/i.test(fa)?'_html':'_text',ha={};return ha[ga]=fa,B(aa,ha,ca)}},$=[];P.removeNode=t,P.configs=c,P.find=L,P.setId=_=>{P.id=_},P.clearCache=_=>{W[_]&&delete W[_]},b.fill=P}(mag,[]),function(b){function f(h,j,l,n){function q(t){return r.has(t)}var r=new WeakSet;return new Proxy(h,{get:function(t,u,v){var w=t[u];if('symbol'==typeof u)return w;if('object'!=typeof w||'symbol'==typeof w||null===w||'function'==typeof w||Array.isArray(w)||!b.utils.isObject(w)||w.then||w.draw)u in t||~b.fill.ignorekeys.indexOf(u.toString())||l||'_'==u[0]||(w=b.proxy({},j,l,n+g+u));else if(!q(w))return r.add(w),b.proxy(w,j,l,n+g+u);var x=j({type:'get',object:t,name:u,path:n,oldValue:Reflect.get(t,u,v)});return'undefined'!=typeof x&&(w=x==b.MAGNUM?void 0:x),w},deleteProperty:function(t,u){return j({type:'delete',name:u,object:t,oldValue:Reflect.get(t,u)}),Reflect.deleteProperty(t,u)},set:function(t,u,v,w){var x=Reflect.get(t,u,w);return x===v&&'length'!==u||(j({type:'set',name:u,object:t,oldValue:x}),Reflect.set(t,u,v,w))}})}var g='/';b.proxy=function(h,j,l,n){for(var q in h){var r=typeof h[q];Array.isArray(h[q])&&101>h[q].length?h[q]=f(h[q],j):'object'==r&&null!==h[q]&&'symbol'!=typeof q&&'symbol'!=r&&'function'!=r&&b.utils.isObject(h[q])&&(h[q]=b.proxy(h[q],j,l,n+g+q))}return f(h,j,l,n||g)}}(mag,window||global||this);
