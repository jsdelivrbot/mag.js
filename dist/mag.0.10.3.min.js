(function(c,n,t,i){var l=1,m=[],g="_key";function j(D){return Object.prototype.toString.call(D)==="[object Array]"}function o(F){if(F.id!==""){return'id("'+F.id+'")'}if(F===t.body){return F.tagName}var D=0;if(!F.parentNode){return}var H=F.parentNode.childNodes;for(var E=0;E<H.length;E++){var G=H[E];if(G===F){return o(F.parentNode)+"/"+F.tagName+"["+(D+1)+"]"}if(G.nodeType===1&&G.tagName===F.tagName){D++}}}function v(D){var E=o(D);if(D.queryCache){}D.parentNode.removeChild(D);if(m[E+"-config"]&&m[E+"-config"].configContext&&typeof m[E+"-config"].configContext.onunload==="function"){m[E+"-config"].configContext.onunload(m[E+"-config"].configContext,D,E)}p(E)}function y(E){var D=E&&parseInt(E.split("[").pop().slice(0,-1));if(!D){return 0}return parseInt(D)-1}function p(E){delete m[E];for(var D in m){if(D.indexOf(E)===0){delete m[D]}}}var e={};var m=[],b={},h=false;function w(I,L,O){var H;var N;var M;if(!I){return}if(L==null){L={_text:""}}var D=d(I);M=j(L);if(M){b[O]=b[O]||0;if(e[O]&&D.length===0){e[O].parent.insertAdjacentHTML("beforeend",e[O].node);D=d(e[O].parent.children);if(typeof L[0]==="object"){}}if(D.length===0){b[O]=0;return}N=D[0].parentNode;if(!e[O]){e[O]={node:D[0].cloneNode(true).outerHTML,parent:N}}while(D.length<L.length){if(e[O]){N.insertAdjacentHTML("beforeend",e[O].node);H=N.lastChild}else{H=D[0].cloneNode(true)}D.push(H);if(N){N.appendChild(H)}}if(typeof D[0].__key==="undefined"&&typeof L[0]==="object"){}var F=D.map(function(R){return R.__key});var P=L.map(function(R){return R[g]});if(D.length==L.length||P.indexOf(i)!==-1){var L=L.map(function(S,R){if(typeof S==="object"){if(D[R].__key&&typeof S[g]==="undefined"){S[g]=D[R].__key;return S}if(typeof S[g]==="undefined"){S[g]="__magnum__"+b[O]++}D[R].__key=S[g]}return S})}if(D.length>L.length){if(L.length===0||typeof L[0]!=="object"){while(D.length>L.length){H=D.pop();N=H.parentNode;if(N){v(H)}}}else{var Q=[];var G=L.map(function(R){return R[g]});var J=D.map(function(R){return R.__key});var D=D.filter(function(S,R){if(G.indexOf(S.__key)===-1||Q.indexOf(S.__key)!==-1){Q.push(S.__key);v(S);return false}Q.push(S.__key);return true})}}}for(var K=0;K<D.length;K++){var E=o(D[K]);if(M){if(D[K]){if(m[E]&&m[E]===JSON.stringify(L[K])){}w(D[K],L[K]);if(D[K].queryCache){}}}else{if(L&&typeof L==="object"&&Object.keys(L).indexOf(g)!==-1){D[K].isChildOfArray=true;D[K]._dataPass=L}B(D[K],L)}}return I}function s(D){if(D.parentNode&&D.parentNode.isChildOfArray){return D.parentNode}else{if(D.parentNode){return s(D.parentNode)}}}function B(F,I){var H,L,J,D;if(typeof I==="function"){return}if(typeof I!=="object"){return B(F,{_text:I})}for(var P in I){var O=I[P];if(O===i){O=""}else{if(O===null&&["onunload"].indexOf(P)===-1){var K=k(F,P);K.forEach(function(Q){v(Q)})}}if(P[0]==="_"){H=H||{};H[P.substr(1)]=O}}var E=o(F);if(H){z(F,H)}var M=0,G=["willupdate","didupdate","didload","willload"];for(var P in I){if(G.indexOf(P)!==-1){continue}var O=I[P];if(P[0]!=="_"){D=k(F,P);if(typeof O==="function"&&O.type=="fun"){try{O=O()}catch(N){}}if(j(O)){D=k(F,"$"+P)}w(D,O,E+"/"+P);M++}}}function d(E){var D;if(E.length==null){E=[E]}if(!j(E)){D=[];for(var F=0;F<E.length;F+=1){if(E[F]){D.push(E[F])}}E=D}return E}function z(F,G){var D=o(F),K=y(D);if(m[D]&&m[D]===JSON.stringify(G)){}F._events=F._events||[];for(var L in G){if(L==="text"||L==="html"){continue}if(L.indexOf("on")==0){if(F._events.indexOf(L)!==-1&&!h){continue}var I=function(N,P,O,R){try{var Q=s(P);return N.call(P,R,O,P,(Q||{})._dataPass,Q)}finally{c.redraw()}}.bind(null,G[L],F,K);F[L]=I;F._events.push(L)}else{if(L=="config"){var J=true;if(!m[D+"-config"]){m[D+"-config"]={}}else{J=false}var E=m[D+"-config"].configContext=m[D+"-config"].configContext||{};var M=function(O,N){return function(){return O.apply(O,N)}};n.push(M(G[L],[F,J,E,K]));continue}var H={key:L,value:G[L],node:F};c.hook("attributes",L,H);if(H.change){L=H.key;G[L]=H.value}if(G[L]===null){F.removeAttribute(L)}else{F.setAttribute(L,G[L].toString())}}}x(F,G.text);u(F,G.html);if(F.queryCache){}}function x(F,H){var I;var E;var G=o(F);if(!F||H==null){return}if(!E){E=[];for(var D=0;D<F.childNodes.length;D+=1){I=F.childNodes[D];if(I.nodeType===l){E.push(I)}}}while(F.firstChild){F.removeChild(F.firstChild)}if(F.nodeName.toLowerCase()==="input"){F.setAttribute("value",H.toString())}else{F.appendChild(F.ownerDocument.createTextNode(H.toString()))}for(var D=0;D<E.length;D+=1){F.appendChild(E[D])}}function a(D){if(D.cloner){D.id="__magnum__::"+D.id.split("__magnum__::").pop()}}function u(F,E){if(!F||E==null){return}while(F.firstChild){F.removeChild(F.firstChild)}if(typeof E==="function"&&E().nodeType===1){a(E());var D=t.createElement("span");F.appendChild(D);try{F.replaceChild(E(),D)}catch(G){console.log("FILL HTML ERROR",E().id,G)}}else{if(E.nodeType===1){a(E);var D=t.createElement("span");F.appendChild(D);F.replaceChild(E,D)}else{F.innerHTML=E}}}function k(F,K,J){var D=A(F);var I=[];var L=K;var E=K[0]==="$";if(L[0]==="$"){L=L.substr(1)}for(var H=0;H<D.length;H+=1){if(C(D[H],L)){I.push(D[H])}}if(!I.length||E){for(var H=0;H<D.length;H++){I=I.concat(k(D[H],K,true));if(I.length&&!E){break}}}if(!J&&!I.length){var G={key:K,value:I,node:F};c.hook("elementMatcher",K,G);if(G.change){}}return I}function A(F){var E=F.childNodes;var G=[];for(var D=0;D<E.length;D+=1){if(E[D].nodeType===l){G.push(E[D])}}return G}function C(E,D){var F=" "+E.className+" ";return(E.id===D||F.indexOf(" "+D+" ")>-1||E.name===D||E.nodeName.toLowerCase()===D.toLowerCase()||E.getAttribute("data-bind")===D)}function r(){h=true}function f(F,I){var I={tagName:F.tagName};if(F.firstChild||F.children[0]){var G=F.firstChild||F.childNodes[0];var H=G.nodeValue||G.value||G.innerText;if(H){H=H.replace(/\u00a0/g,"x").trim()}if(H){I.tagValue=H}}var E=0;for(E;E<F.attributes.length;E++){I[F.attributes[E].name]=F.attributes[E].value}var D=F.children;if(D.length){I.children=[];E=0;for(E;E<D.length;E++){var J=D[E];I.children[E]=f(J,I.children)}}return I}function q(){h=false}c.fill={fill:w,elementToObject:f,cached:m,find:k,clear:r,unclear:q,configs:n};window.mag=c}(window.mag||{},[],document));(function(b){var a={modules:[],promises:[],deferreds:[],controllers:[],elements:[]};a.getController=function(e,d,f){var c;if(typeof Proxy!=="undefined"){c=new Proxy(new e.controller,{get:function(j,l){if(j[l]===undefined&&["watchers","toJSON","called","onload","onunload"].indexOf(l)===-1){var g=f.find(d,l),k=l[0]==="$",h,i=[];g.forEach(function(n,m){if(g[m]){if(g[m].value&&g[m].value.length>0){h=g[m].value;if(g[m].type&&(g[m].type=="checkbox"||g[m].type=="radio")){h={_text:h,_checked:g[m].checked};i.push(h)}}else{if(g[m].innerText&&g[m].innerText.length>0){h=g[m].innerText}else{if(g[0].innerHTML&&g[m].innerHTML.length>0){h=g[m].innerHTML}}}}});if(i.length>0&&k){return i}return h}return j[l]}})}else{c=new e.controller}return c};a.submodule=function(g,f){var d=function(h){return(g.controller||function(){}).apply(this,h)}.bind({},f);var c=function(k,j){if(arguments.length>1){var h=f.concat([].slice.call(arguments,1))}var i=g.view.apply(g,h?[k].concat(h):[k]);if(f[0]&&f[0].key!=null){i.attrs.key=f[0].key}};d.$original=g.controller;d.$$args=f;var e={controller:d,view:c};if(f[0]&&f[0].key!=null){e.attrs={key:f[0].key}}return e};a.getArgs=function(d){var c=a.modules[d].controller&&a.modules[d].controller.$$args?[a.controllers[d]].concat(a.modules[d].controller.$$args):[a.controllers[d]];return c};b.mod=a})(window.mag||{});(function(g){var c={roots:[],contexts:[],templates:{},cache:{}};var d=[],e=[],f=0;function h(q,v,u){var r=v.getArgs(u);var t=v.modules[u];var p=v.controllers[u];var s=c.contexts[u]=c.contexts[u]||{};try{t.view(r[0],q,s)}catch(w){console.log("Mag.JS",q.id,u,w)}}c.unloaders=[];c.callLCEvent=function(r,u,s,v){var p=false;var w={preventDefault:function(){p=true}};if(u.controllers[s][r]){u.controllers[s][r].call({},w,u.elements[s]);if(v){u.controllers[s][r]=0}}if(p){for(var t=0,q;q=c.unloaders[t];t++){if(q.controller.onunload){q.handler.call(q.controller,u.elements[s]);q.controller.onunload=0}}}return p};c.callConfigs=function(r){for(var q=0,p=r.length;q<p;q++){r[q]()}};var a=[];c.redraw=function(p,r,q){p=p||c.module||{};if(q){a=[]}this.fun=(this.fun||l(function(s){r.configs.splice(0,r.configs.length);c.doLoop(p,r)}));this.fun()};function i(r,s,q){for(var p in s.cached){if(p.indexOf('id("'+r.elements[q].id+'")/')!==-1){if(s.cached[p].configContext){c.unloaders.push({controller:s.cached[p].configContext,handler:s.cached[p].configContext.onunload})}}}}c.doLoop=function(s,t){for(var r=0,p;p=c.roots[r];r++){if(s.controllers[r]&&s.elements[r]){if(c.callLCEvent("willload",s,r,1)){return}if(!c.innerLoop(s,t,r)){}else{s.deferreds[r][2]({_html:g.prop(s.elements[r])});c.callLCEvent("didload",s,r,1);c.callConfigs(t.configs);i(s,t,r);if(s.deferreds[r][0]){var q=s.deferreds[r][1];delete s.elements[q],s.modules[q],s.controllers[q],s.promises[q],s.deferreds[q]}}}}t.unclear()};c.clear=function(q,p,r){if(q!==-1&&a[q]){r.clear()}};c.innerLoop=function(s,t,r){var p=s.elements[r];var q=s.getArgs(r);if(a[r]&&a[r]===JSON.stringify(q)){return false}h(p,s,r);a[r]=JSON.stringify(q);c.setupWatch(q,t,p,r,s);t.fill(p,q[0]);return true};var o;c.doWatch=function(v,u,r,q,s,t){if(t==o){return}o=t;c.callLCEvent("willupdate",q,r,1);var p=q.getArgs(r);if(a[r]&&a[r]===JSON.stringify(p)){c.callLCEvent("didupdate",q,r);return}h(u,q,r);a[r]=JSON.stringify(p);v.fill(u,p[0])};c.setupWatch=function(r,u,p,t,s){g.runner=false;var q=function(v){v.forEach(function(w){});s.controllers[t]=r[0];l(c.doWatch.bind({},u,p,t,s,v))()};n(r[0],q)};var m=window.cancelAnimationFrame||window.clearTimeout;var j=window.requestAnimationFrame||window.setTimeout;var l=function(s,r){var q,p=r||16,t;return function(){if(+new Date-q>p||j===window.requestAnimationFrame){if(t>0){m(t)}var v=arguments;t=j(function(){q=+new Date;var w=[].slice.call(arguments).concat([].slice.call(v));s.apply(this,w)},p)}else{q=+new Date;var u=[].slice.call(arguments).concat([].slice.call(v));s.apply(this,u);t=j(function(){t=null},p)}}};g.render=c;function k(q,s,p){var r;return function(){var w=this,v=arguments;var u=function(){r=null;if(!p){q.apply(w,v)}};var t=p&&!r;clearTimeout(r);r=setTimeout(u,s);if(t){q.apply(w,v)}}}function b(q){var r=Object.getNotifier(q);for(var p in q){var s=q[p];if(!s||typeof s!=="object"){break}Object.observe(s,function(t){t.forEach(function(u){r.notify(u)})});b(s)}}function n(p,q){if(p&&typeof Object.observe!=="undefined"){b(p);Object.observe(p,k(q,16,1))}}})(window.mag||{});(function(g,j,d){var b=g.mod,a=g.render,o=g.fill,c,i={}.toString,l="function",e="[object Object]";var n=false;g.redraw=function(p){if(n||g.running){}n=true;a.redraw(b||a.module||{},o,p);n=false};g.withProp=function(q,p){return function(s){s=s||event;var r=s.currentTarget||this;p(q in r?r[q]:r.getAttribute(q))}};g.prop=function(p){if(((p!=null&&i.call(p)===e)||typeof p===l)&&typeof p.then===l){return m(p)}return k(p)};function k(p){var q=function(){if(arguments.length){p=arguments[0];g.redraw()}return p};q.type="fun";q.toJSON=function(){if(p&&p.nodeType){return o.elementToObject(p)}return p};return q}function m(q,p){var r=g.prop(p);q.then(r);r.then=function(t,s){return m(q.then(t,s),p)};return r}var f={attributes:[],elementMatcher:[]};g.hookin=function(p,q,r){f[p].push({context:{},handler:r,key:q})};g.hook=function(p,r,t,s){for(var q in f[p]){t.changed=false;if(f[p][q].key==r){s=JSON.stringify({v:t.value,k:t.key});f[p][q].handler.call(f[p][q].context,t);if(s!==JSON.stringify({v:t.value,k:t.key})){t.change=true}}}};var h;g.module=function(r,w,u,v){var q=a.roots.indexOf(r);if(u&&!u.retain){a.clear(q,r,o)}if(q<0||v){q=a.roots.length}var t=j.getElementById(r);if(!t){throw Error("Mag.JS Module - invalid node id: "+r)}a.roots[q]=t.id;if(!w.view){throw Error("Mag.JS module - requires a view: "+JSON.stringify(w))}var s=b.submodule(w,[Object.freeze(u||{})]);var p=b.getController(s,t,o);b.controllers[q]=p;if(p.onunload){a.unloaders.push({controller:p,handler:p.onunload})}b.modules[q]=s;b.elements[q]=v?t.cloneNode(true):t;b.elements[q].cloner=v;b.promises[q]=new Promise(function(y,x){b.deferreds[q]=arguments}.bind({},v,q));g.redraw();return m(b.promises[q],{_html:g.prop(b.elements[q])})}})(window.mag||{},document);
