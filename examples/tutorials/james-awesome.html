<!DOCTYPE html>
<html lang="en">
<!-- http://ratfactor.com/daves-guide-to-mithril-js -->
<!-- http://jlongster.com/Removing-User-Interface-Complexity,-or-Why-React-is-Awesome -->

<head>
  <meta charset="UTF-8">
  <title>Mike's Guide to MagJS - code examples</title>
  <link href="http://www.picnicss.com/nut/picnic_3_2.min.css" rel="stylesheet">
  <script src="//rawgit.com/magnumjs/mag.js/master/mag.min.js"></script>

  <link href="//rawgit.com/magnumjs/mag.js/master/examples/tutorials/prism.css" rel="stylesheet">
  <script src="//rawgit.com/magnumjs/mag.js/master/examples/tutorials/prism.js"></script>

  <style type="text/css">
    body { margin: 2em; }
    #Box span {line-height: 1em;
display: block;
    font-size: 3em;}
    #Box { text-align:center;}
    .hide {display:none;}
    		pre>code { background-color: transparent; }
    		.output { background-color: #DDE4E9; padding: 1em; }
    		.page { margin: 1em; padding: 1em; background-color: #FFE; }
    		.spaced { margin: 1em; }
  </style>
</head>

<body>

  <h1>Converted to MagJS - <a href="http://jlongster.com/Removing-User-Interface-Complexity,-or-Why-React-is-Awesome">Removing User Interface Complexity, or Why React is Awesome</a></h2>
<h2><i>JavaScript and HTML interaction - the simple elegant way</i></h2>

<blockquote>No JavaScript code in HTML and no HTML code in JavaScript!</blockquote>

<p><a href="//github.com/magnumjs/mag.js">MagJS</a> is a marvelously tiny JavaScript library by Michael Glazer. 
The functionality it provides works best when it is used as a standalone library for simple HTML interpolations without the need for any special templating syntax.</p>


<h2>Tiniest useful example</h2>

<p>This is what a component looks like with our library. 
It shows a number and a button that, when pressed, increments the number.
view provides the initial state of the object that can be accessed with "state".</p>


<p>And here's the same thing using MagJS:</p>

<div class="row">
	<div id="Box-code" class="language-javascript"></div>
  <div id="Box-html" class="language-markup"></div>
  <div id="Box" class="output"><span></span><button></button></div>
</div>

<script showme="Box-code">
var Box = {
  updateNumber: function() {
    this.number++;
  },
  view: function(state, props) {
    state.span = props.number
    state.button = { _onclick: this.updateNumber.bind(props) , _text: 'Increment' }

  }
}
mag.module("Box", Box,{
  number : 0
})
</script>

<p>Properties are available as the second argument to the view "props" and represent the data passed into the component. Components should never mutate their properties. </p>


 <h2>Data Flow</h2>

<p>We expressed our component's structure in JavaScript instead of trying to mangle it into the DOM. This makes data flow very natural, since we have direct access to the component instance. If you use the DOM directly, it's common to have to wire up the data flow in JavaScript afterwards. A templating engine with automatic bindings helps, but it still creates more complexity than necessary. The days of having one big HTML file are gone; components and their behaviors are intimately dependant and should be encapsulated like so. </p>

  
<div class="row">
	<div id="App-code" class="language-javascript"></div>
  <div id="App" class="output"><span></span><button></button></div>
</div>

<script showme="App-code">
var App = Bloop.createClass({
  getInitialState: function() {
    return { number: 0 };
  },

  updateNumber: function(value) {
    this.state.number = value;
  },

  render: function() {
    return dom.div(
      dom.span(this.state.number),
      Toolbar({
        number: this.state.number,
        onChange: this.updateNumber
      })
    );
  }
});

var Toolbar = Bloop.createClass({
  render: function() {
    return dom.div(
      dom.button({
        onClick: this.props.onChange.bind(null, this.props.number - 1)
      }, 'decrement'),
      dom.button({
        onClick: this.props.onChange.bind(null, this.props.number + 1)
      }, 'increment')
    );
  }
});
</script>
  
<h2>TL;DR</h2>

<p>MagJS loosely encourages an MVC or MVVM architecture. 
Your MagJS-based application renders itself on the page by generating virtual DOM elements which are automatically redrawn as needed.
MagJS provides a set of features which work well together but is otherwise unopinionated about the structure of your application.</p>

<h2>Colophon</h2>

<h3>This Page</h3>

<p>All of the source code displayed on this page is being retrieved from the <code>innerHTML</code> contents of the actual <code>&lt;script&gt;</code> tags on the page.
I'm using MagJS's <code>render()</code> and <code>m()</code> functions to help me do this compactly.
I'll call the script Galadriel and here is her source (displayed by herself, naturally):</p>



<div id="galadriel" class="language-javascript"></div>

<script showme="galadriel">
  function htmlEntities(str) {
    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}
    function addHtml(attachto, html){
  var pre= document.createElement('pre');
  var code= document.createElement('code');
  code.innerHTML = html 
  pre.appendChild(code)
  attachto.appendChild(pre) 
  }
var scripts = document.getElementsByTagName("script");
for(var i=0; i<scripts.length; i++){
  s = scripts[i];
  showme = s.getAttribute("showme");

  attachto = document.getElementById(showme);

  if(!showme || !attachto){ continue; }

    var htmlName = showme.split('-').shift()
 
    var htmlCon = document.getElementById(htmlName)
    var htmlAttachTo = document.getElementById(htmlName+'-html')
  

  addHtml(attachto, s.innerHTML)
  
  if(htmlCon && htmlAttachTo) {
    addHtml(htmlAttachTo,htmlEntities(htmlCon.outerHTML))
            }}
</script>

<blockquote><i>"I know what it was that you saw, for that is also in my mind."</i> - Galadriel</blockquote>

<p>I am using the <a href="http://prismjs.com/">Prism</a> syntax highlighter to beautify the source code.</p>

<h3>Your feedback</h3>

<p>I want it.  You can help me out by <a href="https://github.com/magnumjs/mag.js/issues">creating an issue</a> with corrections to this article or if you have any way of improving it. I also really appreciate feedback on spelling and grammar. Thank you.</p>

<p><small>Copyright (c) 2015 <a href="https://github.com/magnumjs/mag.js">Michael Glazer</a></small></p>

</body>
</html>
