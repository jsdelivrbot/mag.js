<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="style.css">
  <script src="//rawgit.com/magnumjs/mag.js/master/new/dist/mag.0.7.1.min.js"></script>
</head>

<body>
  <div id="hello">
    <h1></h1>
  </div>

  <div id="test" class="hide">
    <button>click</button>
    <span class="test">default</span> 
    <span class="name"></span>
    <div id="passFail2" class="hide">
      <div class="messaging"></div>
    </div>
    <b>default</b>
  </div>

  <div id="contacts" class="hide">
    <h2></h2>
    <div id="form">
      <input name="name" />
      <input name="email" />
      <button>Save</button>
    </div>
    <ul id="list" class="hide">
      <li class="contact">
        <span class="name"></span>
      </li>
    </ul>
  </div>

  <div id="todos">
    <h3>Todos</h3>
    <div class="total">
      <b class="remaining"></b> 
      <span class="size"></span> 
      <a href="#">[archive]</a>
    </div>
    <ul>
      <li class="todoItem">
        <input type="checkbox" /><span class="text"></span>
      </li>
    </ul>
    <input placeholder="Add todo!">
    <button>Add</button>
  </div>

  <div id="build" class="hide">
    <a href="">Nested - module - build</a> 
    <div class="more"></div>
  </div>

  <div id="lister">
    <h2>Hello <span></span></h2>
    <ul>
      <li class="item"></li>
    </ul>
  </div>

  <div id="count">
    <button>Increment</button>
    count: <span class="count"></span>
  </div>

  <div id="modalCase">
    <div id="modal" class="hide">
      <section class="modal">
        <section class="wrapper">
        </section>
        <button class="close-modal">Close</button>
      </section>
    </div>
    <button>Open</button>
  </div>

  <script>
    var modal = {
      controller: function(props) {
        this.visible = mag.prop(props.visible || false)
      },
      view: function(element, props, state) {
        if (state.visible()) {
          element.classList.remove('hide')
          state.wrapper = {
            _html: props.content()
          }
        } else {
          element.classList.add('hide')
        }
        state.button = {
          _onclick: function() {
            state.visible(false)
          }
        }
      }
    }

    mag.module('modalCase', {
      view: function(element, props, state) {
        state.button = {
          _onclick: function() {
            state.modal = mag.module('modal', modal, {
              visible: true,
              content: function() {
                return '<b>HTML</b>'
              }
            })
          }
        }
      }
    })
    
     mag.module("lister", {
      view: function(element, props, state) {
        var name1 = 'Yo!',
          name2 = 'Joe!'
        state.h2 = {
          _config: function(element, isNew, context) {
            context.onunload = function() {
              console.log('test')
            }
            state.span = name1
            state.item = [1, 2, 3]
            mag.redraw()
          },
          _onclick: function() {
            state.item.reverse()
            state.span = state.span == name1 && name2 || name1
          }
        }
      }
    })

     mag.module('lister', {
      controller: function(props) {
        this.item = [1, 2, 3]
        this.title = 'Lister'
      },
      view: function(element, props, state) {
        state.h2 = {
          _text: state.title,
          _onclick: function() {
            state.show = state.show ? !state.show : true
            state.item.reverse()
            state.title = 'Gister' + state.show
          }
        }
      }
    })

     mag.module("count", {
      view: function(element, props, state) {
        state.button = {
          _onclick: function() {
            state.count = state.count + 1 || 1
          }
        }
      }
    })
     mag.module('hello', {
      controller: function(props) {
        this.onload = function(ele) {
          console.log('hello onload')
        }
      },
      view: function(element, props, state) {
        state.h1 = 'Hello Mag.JS!'
      }
    })
    
  </script>
  <script src="contacts.js"></script>
  <script src="script.js"></script>
</body>

</html>
