(function(u,n,k,w){function p(c){return"[object Array]"===Object.prototype.toString.call(c)}function q(c){if(""!==c.id)return'id("'+c.id+'")';if(c===k.body)return c.tagName;var d=0;if(c.parentNode)for(var b=c.parentNode.childNodes,e=0;e<b.length;e++){var g=b[e];if(g===c)return q(c.parentNode)+"/"+c.tagName+"["+(d+1)+"]";1===g.nodeType&&g.tagName===c.tagName&&d++}}function m(c,d,b){var e,g,h;if(c){null==d&&(d={_text:""});var t=f(c);if(h=p(d)){z[b]&&0===t.length&&(z[b].parent.insertAdjacentHTML("beforeend",
z[b].node),t=f(z[b].parent.children));if(0===t.length)return;g=t[0].parentNode;for(z[b]||(z[b]={node:t[0].cloneNode(!0).outerHTML,parent:g});t.length<d.length;)z[b]?(g.insertAdjacentHTML("beforeend",z[b].node),e=g.lastChild):e=t[0].cloneNode(!0),t.push(e),g&&g.appendChild(e);for(;t.length>d.length;)if(e=t.pop(),g=e.parentNode)if(b=q(e),g.removeChild(e),v[b+"-config"]&&v[b+"-config"].configContext&&"function"===typeof v[b+"-config"].configContext.onunload)v[b+"-config"].configContext.onunload()}for(e=
0;e<t.length;e++)b=q(t[e]),h?!t[e]||v[b]&&v[b]===JSON.stringify(d[e])||(m(t[e],d[e]),v[b]=JSON.stringify(d[e])):C(t[e],d);return c}}function C(c,d){var b;if("function"!==typeof d){if("object"!==typeof d)return C(c,{_text:d});for(var e in d){var g=d[e];g===w&&(g="");"_"===e[0]&&(b=b||{},b[e.substr(1)]=g)}var f=q(c);if(b){if(v[f]&&v[f]===JSON.stringify(b))return;h(c,b);v[f]=JSON.stringify(b)}var t=0;for(e in d)if(g=d[e],"_"!==e[0]){b=B(c,e);if("function"===typeof g&&"fun"==g.type)try{g=g()}catch(k){}p(g)&&
(b=B(c,"$"+e));m(b,g,f+"/"+e);t++}}}function f(c){var d;null==c.length&&(c=[c]);if(!p(c)){d=[];for(var b=0;b<c.length;b+=1)c[b]&&d.push(c[b]);c=d}return c}function h(c,d){x(c,d.text);y(c,d.html);c._events=c._events||[];for(var b in d)if("text"!==b&&"html"!==b)if(0==b.indexOf("on")){if(-1===c._events.indexOf(b)){var e=function(c,b,d){try{return c.call(b,d)}finally{u.redraw()}}.bind(null,d[b],c);c.addEventListener(b.substr(2),e);c._events.push(b)}}else if("config"==b){var e=!0,g=q(c);v[g+"-config"]?
e=!e:v[g+"-config"]={};g=v[g+"-config"].configContext=v[g+"-config"].configContext||{};n.push(function(c,b){return function(){return c.apply(c,b)}}(d[b],[c,e,g]))}else null===d[b]?c.removeAttribute(b):c.setAttribute(b,d[b].toString())}function x(c,d){var b,e;if(c&&null!=d){if(!e){e=[];for(var g=0;g<c.childNodes.length;g+=1)b=c.childNodes[g],1===b.nodeType&&e.push(b)}for(;c.firstChild;)c.removeChild(c.firstChild);"input"===c.nodeName.toLowerCase()?c.setAttribute("value",d.toString()):c.appendChild(c.ownerDocument.createTextNode(d.toString()));
for(g=0;g<e.length;g+=1)c.appendChild(e[g])}}function y(c,d){c&&null!=d&&(c.innerHTML=d)}function B(c,d,b){var e=c.childNodes;b=[];for(var g=0;g<e.length;g+=1)1===e[g].nodeType&&b.push(e[g]);e=[];g=d;if(!(c.queryCache||{})[d]){c.queryCache=(c.queryCache||{})[d]=[];var f="$"===d[0];"$"===g[0]&&(g=g.substr(1));for(var h=0;h<b.length;h+=1){var m=b[h],k=g,v=" "+m.className+" ";(m.id===k||-1<v.indexOf(" "+k+" ")||m.name===k||m.nodeName.toLowerCase()===k.toLowerCase()||m.getAttribute("data-bind")===k)&&
e.push(b[h])}if(!e.length||f)for(h=0;h<b.length&&(e=e.concat(B(b[h],d,!0)),!e.length||f);h++);c.queryCache[d]=e}return c.queryCache[d]}var v=[],z={},v=[];u.fill={fill:m,configs:n};window.mag=u})(window.mag||{},[],document);
(function(u){function n(){t=null;for(var a=0;a<D.length;a++)D[a]();D.length=0}var k={noMore:!1,useDirtyCheck:!1},w=[],p=[],q=[],m=!1;try{m=Object.defineProperty&&Object.defineProperty({},"x",{})}catch(C){}var f=function(a){var r={};return a&&"[object Function]"==r.toString.call(a)},h=function(a){return"[object Array]"===Object.prototype.toString.call(a)},x=function(a){return"[object Object]"==={}.toString.apply(a)},y=function(a){if(null==a||"object"!=typeof a)return a;var r=a.constructor(),c;for(c in a)r[c]=
a[c];return r},B=function(a,r,c,b){try{Object.observe(a,function(a){a.forEach(function(a){a.name===r&&b(a.object[a.name])})})}catch(A){try{Object.defineProperty(a,r,{get:c,set:function(a){b.call(this,a,!0)},enumerable:!0,configurable:!0})}catch(d){try{Object.prototype.__defineGetter__.call(a,r,c),Object.prototype.__defineSetter__.call(a,r,function(a){b.call(this,a,!0)})}catch(e){z(a,r,b)}}}},v=function(a,r,c){try{Object.defineProperty(a,r,{enumerable:!1,configurable:!0,writable:!1,value:c})}catch(b){a[r]=
c}},z=function(a,r,c){p[p.length]={prop:r,object:a,orig:y(a[r]),callback:c}},c=function(a,r,b,l){if("string"!=typeof a&&(a instanceof Object||h(a))){if(h(a)){if(J(a,"__watchall__",r,b),void 0===b||0<b)for(var A=0;A<a.length;A++)c(a[A],r,b,l)}else{var e=[];for(A in a)"$val"==A||!m&&"watchers"===A||Object.prototype.hasOwnProperty.call(a,A)&&e.push(A);d(a,e,r,b,l)}l&&K(a,"$$watchlengthsubjectroot",r,b)}},d=function(a,c,e,l,A){if("string"!=typeof a&&(a instanceof Object||h(a)))for(var d=0;d<c.length;d++)b(a,
c[d],e,l,A)},b=function(a,r,b,l,d){"string"!=typeof a&&(a instanceof Object||h(a))&&!f(a[r])&&(null!=a[r]&&(void 0===l||0<l)&&c(a[r],b,void 0!==l?l-1:l),J(a,r,b,l),d&&(void 0===l||0<l)&&K(a,r,b,l))},e=function(a,c){if(!(a instanceof String)&&(a instanceof Object||h(a)))if(h(a)){for(var b=["__watchall__"],l=0;l<a.length;l++)b.push(l);g(a,b,c)}else{var d=function(a){var b=[],l;for(l in a)a.hasOwnProperty(l)&&(a[l]instanceof Object?d(a[l]):b.push(l));g(a,b,c)};d(a)}},g=function(a,c,b){for(var l in c)c.hasOwnProperty(l)&&
L(a,c[l],b)},D=[],t=null,H=function(){t||(t=setTimeout(n));return t},I=function(a){null==t&&H();D[D.length]=a},F=function(a,b,d,l){var e=null,g=-1,f=h(a);c(a,function(c,l,d,h){var m=H();g!==m&&(g=m,e={type:"update"},e.value=a,e.splices=null,I(function(){b.call(this,e);e=null}));if(f&&a===this&&null!==e){if("pop"===l||"shift"===l)d=[],h=[h];else if("push"===l||"unshift"===l)d=[d],h=[];else if("splice"!==l)return;e.splices||(e.splices=[]);e.splices[e.splices.length]={index:c,deleteCount:h?h.length:
0,addedCount:d?d.length:0,added:d,deleted:h}}},1==d?void 0:0,l)},O=function(a,c,d,l,e){a&&c&&(b(a,c,function(a,c,b,r){a={type:"update"};a.value=b;a.oldvalue=r;(l&&x(b)||h(b))&&F(b,d,l,e);d.call(this,a)},0),(l&&x(a[c])||h(a[c]))&&F(a[c],d,l,e))},J=function(a,b,d,l){var e=!1,g=h(a);a.watchers||(v(a,"watchers",{}),g&&P(a,function(d,e,g,f){M(a,d,e,g,f);if(0!==l&&g&&(x(g)||h(g))){var m,k;d=a.watchers[b];if(f=a.watchers.__watchall__)d=d?d.concat(f):f;k=d?d.length:0;for(f=0;f<k;f++)if("splice"!==e)c(g,d[f],
void 0===l?l:l-1);else for(m=0;m<g.length;m++)c(g[m],d[f],void 0===l?l:l-1)}}));a.watchers[b]||(a.watchers[b]=[],g||(e=!0));for(g=0;g<a.watchers[b].length;g++)if(a.watchers[b][g]===d)return;a.watchers[b].push(d);if(e){var f=a[b];d=function(){return f};e=function(d,e){var g=f;f=d;if(0!==l&&a[b]&&(x(a[b])||h(a[b]))&&!a[b].watchers){var m,v=a.watchers[b].length;for(m=0;m<v;m++)c(a[b],a.watchers[b][m],void 0===l?l:l-1)}a.watchers&&(a.watchers.__wjs_suspend__||a.watchers["__wjs_suspend__"+b])?Q(a,b):k.noMore||
g===d||(e?M(a,b,"set",d,g):E(a,b,"set",d,g),k.noMore=!1)};k.useDirtyCheck?z(a,b,e):B(a,b,d,e)}},E=function(a,b,c,d,e){if(void 0!==b){var g,f=a.watchers[b];if(g=a.watchers.__watchall__)f=f?f.concat(g):g;g=f?f.length:0;for(var h=0;h<g;h++)f[h].call(a,b,c,d,e)}else for(b in a)a.hasOwnProperty(b)&&E(a,b,c,d,e)},N="pop push reverse shift sort slice unshift splice".split(" "),R=function(a,b,c,d){v(a,c,function(){var e=0,g,f,h;if("splice"===c){h=arguments[0];f=a.slice(h,h+arguments[1]);g=[];for(e=2;e<arguments.length;e++)g[e-
2]=arguments[e];e=h}else g=0<arguments.length?arguments[0]:void 0;h=b.apply(a,arguments);"slice"!==c&&("pop"===c?(f=h,e=a.length):"push"===c?e=a.length-1:"shift"===c?f=h:"unshift"!==c&&void 0===g&&(g=h),d.call(a,e,c,g,f));return h})},P=function(a,b){if(f(b)&&a&&!(a instanceof String)&&h(a))for(var c=N.length,d;c--;)d=N[c],R(a,a[d],d,b)},L=function(a,b,c){if(a.watchers[b])if(void 0===c)delete a.watchers[b];else for(var d=0;d<a.watchers[b].length;d++)a.watchers[b][d]==c&&a.watchers[b].splice(d,1);for(d=
0;d<w.length;d++){var e=w[d];e.obj==a&&e.prop==b&&e.watcher==c&&w.splice(d,1)}for(c=0;c<p.length;c++)d=p[c],e=d.object.watchers,(d=d.object==a&&d.prop==b&&e&&(!e[b]||0==e[b].length))&&p.splice(c,1)},Q=function(a,b){I(function(){delete a.watchers.__wjs_suspend__;delete a.watchers["__wjs_suspend__"+b]})},G=null,M=function(a,b,c,d,e){q[q.length]={obj:a,prop:b,mode:c,newval:d,oldval:e};null===G&&(G=setTimeout(S))},S=function(){var a=null;G=null;for(var b=0;b<q.length;b++)a=q[b],E(a.obj,a.prop,a.mode,
a.newval,a.oldval);a&&(q=[])},K=function(a,b,c,d){var e;e="$$watchlengthsubjectroot"===b?y(a):y(a[b]);w.push({obj:a,prop:b,actual:e,watcher:c,level:d})};k.watch=function(){f(arguments[1])?c.apply(this,arguments):h(arguments[1])?d.apply(this,arguments):b.apply(this,arguments)};k.unwatch=function(){f(arguments[1])?e.apply(this,arguments):h(arguments[1])?g.apply(this,arguments):L.apply(this,arguments)};k.callWatchers=E;k.suspend=function(a,b){a.watchers&&(a.watchers["__wjs_suspend__"+(void 0!==b?b:"")]=
!0)};k.onChange=function(){(f(arguments[2])?O:F).apply(this,arguments)};u.watch=k})(window.mag||{});
(function(u){var n={modules:[],controllers:[],elements:[],submodule:function(k,n){var p=function(n){return(k.controller||function(){}).apply(this,n)}.bind({},n);p.$original=k.controller;p={controller:p,view:function(p){1<arguments.length&&(n=n.concat([].slice.call(arguments,1)));var m=k.view.apply(k,n?[p].concat(n):[p]);n[0]&&null!=n[0].key&&(m.attrs.key=n[0].key);return m}};n[0]&&null!=n[0].key&&(p.attrs={key:n[0].key});return p},getArgs:function(k){return n.modules[k].controller&&n.modules[k].controller.$$args?
[n.controllers[k]].concat(n.modules[k].controller.$$args):[n.controllers[k]]}};u.mod=n})(window.mag||{});
(function(u){var n={roots:[],templates:{},cache:{},callOnload:function(m){for(var k=0,f;f=m.controllers[k];k++)f.onload&&!f.called&&(f.onload.call(null,m.elements[k]),f.called=1)},callConfigs:function(m){for(var k=0,f=m.length;k<f;k++)m[k]()}},k=[];n.redraw=function(m,k,f){m=m||n.module||{};this.fun||(this.fun=q(function(){k.configs.splice(0,k.configs.length);n.doLoop(m,k,f)}));this.fun()};n.doLoop=function(k,p,f){for(var h=0;n.roots[h];h++)u.running=!0,k.controllers[h]&&n.innerLoop(k,p,h,f)};n.innerLoop=
function(m,p,f,h){var x=m.elements[f],q=m.getArgs(f);if(k[f]&&k[f]===JSON.stringify(q[0]))return!1;m.getArgs(f);m.modules[f].view(x,m.controllers[f]);k[f]=JSON.stringify(q[0]);n.setupWatch(h,q,p,x,f,m);p.fill(x,q[0]);n.callConfigs(p.configs)};n.doWatch=function(m,p,f,h,q){u.running=!0;q=h.getArgs(f);k[f]&&k[f]===JSON.stringify(q[0])||(h.getArgs(f),h.modules[f].view(p,h.controllers[f]),k[f]=JSON.stringify(q[0]),m.fill(p,q[0]),n.callConfigs(m.configs),n.callOnload(h),u.running=!1)};n.setupWatch=function(k,
p,f,h,u,w){k.watch(p[0],q(n.doWatch.bind(null,f,h,u,w)))};var w=window.cancelAnimationFrame||window.clearTimeout,p=window.requestAnimationFrame||window.setTimeout,q=function(k,n){var f,h=n||16,q;return function(){+new Date-f>h||p===window.requestAnimationFrame?(0<q&&w(q),q=p(function(){f=+new Date;k.apply(this,arguments)},h)):(f=+new Date,k.apply(this,arguments))}};u.render=n})(window.mag||{});
(function(u,n,k){var w={},p=u.mod,q=u.render,m=u.fill,C,f=u.watch;u.running=!1;w.init=function(f,h){};var h=!1;w.redraw=function(){h||(h=!0,q.redraw(p||q.module||{},m,f),h=!1)};w.withProp=function(f,h){return function(c){c=c||event;c=c.currentTarget||this;h(f in c?c[f]:c.getAttribute(f))}};w.prop=function(f){var h=function(){arguments.length&&(f=arguments[0],w.redraw());return f};h.type="fun";h.toJSON=function(){return f};return h};var x=[];w.module=function(f,h,c){var d=q.roots.indexOf(f);0>d&&(d=
q.roots.length);f=n.getElementById(f);if(!f)return Error("invalid node");q.roots[d]=f.id;if(!h.view)return Error("module requires a view");c=C=h=(h=p.submodule(h,[c||{}]))||{};var b=new h.controller;c===C&&(p.controllers[d]=b,b.onunload&&x.push({controller:b,handler:b.onunload}),p.modules[d]=h,p.elements[d]=f);w.redraw();b.onload&&!u.running&&q.callOnload(p);return{_html:f.innerHTML}};k=function(f){return function(){return w[f].apply(this,arguments)}};var y=k("init");y.module=k("module");y.prop=k("prop");
y.redraw=k("redraw");y.withProp=k("withProp");for(var B in y)u[B]=y[B]})(window.mag||{},document);
